{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { ref } from 'vue';\nimport MantencionesTable from '@/components/MantencionesUi/MantencionesTable.vue';\nimport ModalAgregar from '@/components/MantencionesUi/ModalAgregar.vue';\nimport ModalVerMantenciones from '@/components/MantencionesUi/ModalVerMantenciones.vue';\nexport default {\n  __name: 'MantencionesView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const patenteSeleccionada = ref('');\n    const selectedVehiculo = ref(null);\n    const mantencionSeleccionada = ref(null); // Para editar\n\n    const showAddModal = ref(false);\n    const showVerModal = ref(false);\n\n    // Mantenciones por patente\n    const mantencionesPorPatente = ref({});\n\n    // Lista inicial de vehículos\n    const mantenciones = ref([{\n      patente: 'ABC123',\n      odometro: 4500,\n      estado: 'OK'\n    }, {\n      patente: 'XYZ789',\n      odometro: 72000,\n      estado: 'Requiere mantención'\n    }, {\n      patente: 'DEF456',\n      odometro: 60000,\n      estado: 'Próxima mantención'\n    }]);\n    const templates = ref([{\n      id: 1,\n      name: 'Revisión Tecnica',\n      type: 'Por Tiempo',\n      description: 'Verificación completa del vehículo según normativa',\n      used: false\n    }, {\n      id: 2,\n      name: 'Permiso de Circulación',\n      type: 'Por Tiempo',\n      description: 'Gestión y pago del permiso de circulación anual',\n      used: false\n    }, {\n      id: 3,\n      name: 'Cambio de Neumáticos',\n      type: 'Por Odómetro',\n      description: 'Rotación, balanceo y revisión del desgaste de neumáticos',\n      used: false\n    }, {\n      id: 4,\n      name: 'Cambio de Aceite',\n      type: 'Por Odómetro',\n      description: 'Sustitución de aceite y filtro para mantener motor óptimo',\n      used: false\n    }, {\n      id: 5,\n      name: 'Cambio de Filtro de Aire',\n      type: 'Por Odómetro',\n      description: 'Reemplazo del filtro de aire para mejorar eficiencia del motor',\n      used: false\n    }]);\n    function abrirModal(item) {\n      selectedVehiculo.value = item;\n      patenteSeleccionada.value = item.patente;\n      mantencionSeleccionada.value = null; // Nuevo registro\n      showAddModal.value = true;\n    }\n    function cerrarModal() {\n      showAddModal.value = false;\n      selectedVehiculo.value = null;\n      mantencionSeleccionada.value = null;\n    }\n    function verMantenciones(item) {\n      patenteSeleccionada.value = item.patente;\n      showVerModal.value = true;\n    }\n    function guardarMantencion({\n      nuevaMantencion,\n      templateId\n    }) {\n      const patente = patenteSeleccionada.value;\n      if (!mantencionesPorPatente.value[patente]) {\n        mantencionesPorPatente.value[patente] = [];\n      }\n      if (mantencionSeleccionada.value !== null) {\n        // Editar existente\n        mantencionesPorPatente.value[patente][mantencionSeleccionada.value] = nuevaMantencion;\n      } else {\n        // Agregar nuevo\n        mantencionesPorPatente.value[patente].push(nuevaMantencion);\n\n        // BLOQUEAR TEMPLATE\n        const template = templates.value.find(t => t.id === templateId);\n        if (template) template.used = true; // ✅ se marca como usado solo en el padre\n      }\n      cerrarModal();\n    }\n\n    // Editar desde ModalVerMantenciones\n    function editarMantencion(idx) {\n      const patente = patenteSeleccionada.value;\n      mantencionSeleccionada.value = idx;\n      selectedVehiculo.value = {\n        patente\n      };\n      showAddModal.value = true;\n    }\n\n    // Eliminar desde ModalVerMantenciones\n    function eliminarMantencion(idx) {\n      const patente = patenteSeleccionada.value;\n      mantencionesPorPatente.value[patente].splice(idx, 1);\n    }\n    const __returned__ = {\n      patenteSeleccionada,\n      selectedVehiculo,\n      mantencionSeleccionada,\n      showAddModal,\n      showVerModal,\n      mantencionesPorPatente,\n      mantenciones,\n      templates,\n      abrirModal,\n      cerrarModal,\n      verMantenciones,\n      guardarMantencion,\n      editarMantencion,\n      eliminarMantencion,\n      ref,\n      MantencionesTable,\n      ModalAgregar,\n      ModalVerMantenciones\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","MantencionesTable","ModalAgregar","ModalVerMantenciones","patenteSeleccionada","selectedVehiculo","mantencionSeleccionada","showAddModal","showVerModal","mantencionesPorPatente","mantenciones","patente","odometro","estado","templates","id","name","type","description","used","abrirModal","item","value","cerrarModal","verMantenciones","guardarMantencion","nuevaMantencion","templateId","push","template","find","t","editarMantencion","idx","eliminarMantencion","splice"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/Views/MantencionesView.vue"],"sourcesContent":["<template>\n  <div class=\"p-2\">\n    <MantencionesTable :mantenciones=\"mantenciones\" @ver-mantenciones=\"verMantenciones\"\n      @agregar-mantencion=\"abrirModal\" />\n\n    <ModalAgregar v-if=\"showAddModal\" :show-add-modal=\"showAddModal\" :selected-patente=\"patenteSeleccionada\"\n      :mantenciones=\"mantencionesPorPatente[patenteSeleccionada] || []\" :selected-mantencion=\"mantencionSeleccionada\"\n      :templates=\"templates\" @close=\"cerrarModal\" @save=\"guardarMantencion\" />\n\n    <ModalVerMantenciones v-if=\"showVerModal\" :patente=\"patenteSeleccionada\"\n      :mantenciones=\"mantencionesPorPatente[patenteSeleccionada] || []\" @close=\"showVerModal = false\"\n      @editar=\"editarMantencion\" @eliminar=\"eliminarMantencion\" />\n\n  </div>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport MantencionesTable from '@/components/MantencionesUi/MantencionesTable.vue'\nimport ModalAgregar from '@/components/MantencionesUi/ModalAgregar.vue'\nimport ModalVerMantenciones from '@/components/MantencionesUi/ModalVerMantenciones.vue'\n\nconst patenteSeleccionada = ref('')\nconst selectedVehiculo = ref(null)\nconst mantencionSeleccionada = ref(null) // Para editar\n\nconst showAddModal = ref(false)\nconst showVerModal = ref(false)\n\n// Mantenciones por patente\nconst mantencionesPorPatente = ref({})\n\n// Lista inicial de vehículos\nconst mantenciones = ref([\n  { patente: 'ABC123', odometro: 4500, estado: 'OK' },\n  { patente: 'XYZ789', odometro: 72000, estado: 'Requiere mantención' },\n  { patente: 'DEF456', odometro: 60000, estado: 'Próxima mantención' },\n])\n\n\nconst templates = ref([\n  { id: 1, name: 'Revisión Tecnica', type: 'Por Tiempo', description: 'Verificación completa del vehículo según normativa', used: false },\n  { id: 2, name: 'Permiso de Circulación', type: 'Por Tiempo', description: 'Gestión y pago del permiso de circulación anual', used: false },\n  { id: 3, name: 'Cambio de Neumáticos', type: 'Por Odómetro', description: 'Rotación, balanceo y revisión del desgaste de neumáticos', used: false },\n  { id: 4, name: 'Cambio de Aceite', type: 'Por Odómetro', description: 'Sustitución de aceite y filtro para mantener motor óptimo', used: false },\n  { id: 5, name: 'Cambio de Filtro de Aire', type: 'Por Odómetro', description: 'Reemplazo del filtro de aire para mejorar eficiencia del motor', used: false },\n])\n\n\nfunction abrirModal(item) {\n  selectedVehiculo.value = item\n  patenteSeleccionada.value = item.patente\n  mantencionSeleccionada.value = null // Nuevo registro\n  showAddModal.value = true\n}\n\nfunction cerrarModal() {\n  showAddModal.value = false\n  selectedVehiculo.value = null\n  mantencionSeleccionada.value = null\n}\n\nfunction verMantenciones(item) {\n  patenteSeleccionada.value = item.patente\n  showVerModal.value = true\n}\n\nfunction guardarMantencion({ nuevaMantencion, templateId }) {\n  const patente = patenteSeleccionada.value;\n  if (!mantencionesPorPatente.value[patente]) {\n    mantencionesPorPatente.value[patente] = [];\n  }\n\n  if (mantencionSeleccionada.value !== null) {\n    // Editar existente\n    mantencionesPorPatente.value[patente][mantencionSeleccionada.value] = nuevaMantencion;\n  } else {\n    // Agregar nuevo\n    mantencionesPorPatente.value[patente].push(nuevaMantencion);\n\n    // BLOQUEAR TEMPLATE\n    const template = templates.value.find(t => t.id === templateId);\n    if (template) template.used = true; // ✅ se marca como usado solo en el padre\n  }\n\n  cerrarModal();\n}\n\n\n// Editar desde ModalVerMantenciones\nfunction editarMantencion(idx) {\n  const patente = patenteSeleccionada.value\n  mantencionSeleccionada.value = idx\n  selectedVehiculo.value = { patente }\n  showAddModal.value = true\n}\n\n// Eliminar desde ModalVerMantenciones\nfunction eliminarMantencion(idx) {\n  const patente = patenteSeleccionada.value\n  mantencionesPorPatente.value[patente].splice(idx, 1)\n}\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}