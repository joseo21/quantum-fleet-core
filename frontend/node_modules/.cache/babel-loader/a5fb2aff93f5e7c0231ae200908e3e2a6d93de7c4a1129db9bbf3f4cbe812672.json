{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport SvgIcon from '@/components/icons/SvgIcon.vue';\nexport default {\n  name: \"MantencionesCards\",\n  components: {\n    SvgIcon\n  },\n  props: {\n    mantenciones: {\n      type: Array,\n      default: () => []\n    }\n  },\n  data() {\n    return {\n      search: \"\",\n      debouncedSearch: \"\",\n      currentPage: 1,\n      rowsPerPage: 5\n    };\n  },\n  computed: {\n    filteredData() {\n      if (!this.debouncedSearch) return this.mantenciones;\n      return this.mantenciones.filter(item => item.patente.toLowerCase().includes(this.debouncedSearch));\n    },\n    totalPages() {\n      return Math.max(1, Math.ceil(this.filteredData.length / this.rowsPerPage));\n    },\n    paginatedData() {\n      const start = (this.currentPage - 1) * this.rowsPerPage;\n      return this.filteredData.slice(start, start + this.rowsPerPage);\n    },\n    totalVerde() {\n      return this.mantenciones.filter(m => m.estado === 'OK').length;\n    },\n    totalAmarillo() {\n      return this.mantenciones.filter(m => m.estado === 'Próxima mantención').length;\n    },\n    totalRojo() {\n      return this.mantenciones.filter(m => m.estado === 'Requiere mantención').length;\n    }\n  },\n  watch: {\n    search(val) {\n      clearTimeout(this._debounceTimeout);\n      this._debounceTimeout = setTimeout(() => {\n        this.debouncedSearch = val.trim().toLowerCase();\n        this.currentPage = 1;\n      }, 300);\n    },\n    filteredData() {\n      if (this.currentPage > this.totalPages) {\n        this.currentPage = 1;\n      }\n    }\n  },\n  methods: {\n    goToPage(page) {\n      if (page >= 1 && page <= this.totalPages) this.currentPage = page;\n    },\n    formatOdometro(valor) {\n      // Formato con separador de miles y dos decimales\n      const num = parseFloat(valor);\n      return isNaN(num) ? '0.00' : num.toLocaleString('es-CL', {\n        minimumFractionDigits: 2,\n        maximumFractionDigits: 2\n      });\n    },\n    clearSearch() {\n      this.search = \"\";\n      this.debouncedSearch = \"\";\n    }\n  }\n};","map":{"version":3,"names":["SvgIcon","name","components","props","mantenciones","type","Array","default","data","search","debouncedSearch","currentPage","rowsPerPage","computed","filteredData","filter","item","patente","toLowerCase","includes","totalPages","Math","max","ceil","length","paginatedData","start","slice","totalVerde","m","estado","totalAmarillo","totalRojo","watch","val","clearTimeout","_debounceTimeout","setTimeout","trim","methods","goToPage","page","formatOdometro","valor","num","parseFloat","isNaN","toLocaleString","minimumFractionDigits","maximumFractionDigits","clearSearch"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/components/MantencionesUi/MantencionesTable.vue"],"sourcesContent":["<template>\n  <div class=\"p-2 sm:p-4 w-full flex flex-col\">\n    <div class=\"flex flex-col xl:flex-row justify-between items-start xl:items-center mb-4 gap-4\">\n      \n      <div class=\"flex w-full xl:w-1/2 flex-col sm:flex-row gap-3 sm:gap-4 items-start sm:items-center\">\n        <div class=\"flex flex-1 w-full sm:w-auto border border-gray-300 dark:border-gray-600 rounded-xl overflow-hidden shadow-inner\">\n          <div class=\"flex items-center justify-center px-3 bg-gray-100 dark:bg-gray-800 text-gray-500\">\n            <SvgIcon name=\"search\" class=\"w-4 h-4 sm:w-5 sm:h-5\" />\n          </div>\n          <input v-model=\"search\" placeholder=\"Buscar patente...\"\n            class=\"flex-1 p-2 text-sm sm:text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-300 focus:outline-none focus:ring-1 focus:ring-[#ff6600]\" />\n          <button v-if=\"search\" @click=\"clearSearch\"\n            class=\"px-4 bg-[#ff6600] hover:bg-[#e65500] text-white font-semibold text-sm transition duration-150 ease-in-out\">\n            Limpiar\n          </button>\n        </div>\n\n        <div class=\"flex items-center text-sm text-gray-600 dark:text-gray-300 flex-shrink-0\">\n          Total de vehículos: <span class=\"font-bold ml-1\">{{ mantenciones.length }}</span>\n        </div>\n      </div>\n      \n      <div class=\"flex gap-3 flex-wrap justify-center sm:justify-start xl:justify-end w-full xl:w-auto\">\n        \n        <div class=\"mini-kpi kpi-green\">\n          <SvgIcon name=\"ok\" class=\"w-5 h-5 mb-1\" />\n          <span class=\"text-xl sm:text-2xl font-extrabold\">{{ totalVerde }}</span>\n          <span class=\"text-xs font-medium uppercase mt-1 text-gray-600 dark:text-gray-300\">Al Día</span>\n        </div>\n\n        <div class=\"mini-kpi kpi-yellow\">\n          <SvgIcon name=\"proxima\" class=\"w-5 h-5 mb-1\" />\n          <span class=\"text-xl sm:text-2xl font-extrabold\">{{ totalAmarillo }}</span>\n          <span class=\"text-xs font-medium uppercase mt-1 text-gray-600 dark:text-gray-300\">Próximas</span>\n        </div>\n\n        <div class=\"mini-kpi kpi-red\">\n          <SvgIcon name=\"vencida\" class=\"w-5 h-5 mb-1\" />\n          <span class=\"text-xl sm:text-2xl font-extrabold\">{{ totalRojo }}</span>\n          <span class=\"text-xs font-medium uppercase mt-1 text-gray-600 dark:text-gray-300\">Vencidas</span>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"space-y-3 max-h-[500px] overflow-y-auto pr-1\">\n      <div v-for=\"(item, idx) in paginatedData\" :key=\"idx\"\n        class=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-lg p-5 transition duration-300 hover:shadow-xl hover:ring-2 hover:ring-[#ff6600]/50 hover:scale-[1.01]\">\n\n        <div class=\"flex flex-col lg:flex-row lg:items-center justify-between gap-4\">\n\n          <div class=\"flex-1 min-w-[150px] border-r border-dashed border-gray-200 dark:border-gray-700 pr-4 lg:pr-8\">\n            <div class=\"flex items-center justify-between mb-2\">\n              <p class=\"text-2xl font-extrabold text-[#102372] dark:text-[#ff6600] tracking-wider\">{{ item.patente }}</p>\n              \n              <div class=\"flex-shrink-0\">\n                <span v-if=\"item.estado === 'OK'\"\n                  class=\"inline-flex items-center gap-1 rounded-full bg-emerald-100 dark:bg-emerald-900 px-3 py-1 text-emerald-700 dark:text-emerald-300 text-xs font-medium shadow-sm border border-emerald-300 dark:border-emerald-600\">\n                  <SvgIcon name=\"ok\" class=\"w-3 h-3\" />\n                  <span>Al día</span>\n                </span>\n\n                <span v-else-if=\"item.estado === 'Próxima mantención'\"\n                  class=\"inline-flex items-center gap-1 rounded-full bg-amber-100 dark:bg-amber-900 px-3 py-1 text-amber-700 dark:text-amber-300 text-xs font-medium shadow-sm border border-amber-300 dark:border-amber-600\">\n                  <SvgIcon name=\"proxima\" class=\"w-3 h-3\" />\n                  <span>Próximo</span>\n                </span>\n\n                <span v-else-if=\"item.estado === 'Requiere mantención'\"\n                  class=\"inline-flex items-center gap-1 rounded-full bg-red-100 dark:bg-red-900 px-3 py-1 text-red-700 dark:text-red-300 text-xs font-medium shadow-sm border border-red-300 dark:border-red-600\">\n                  <SvgIcon name=\"vencida\" class=\"w-3 h-3\" />\n                  <span>Vencida</span>\n                </span>\n              </div>\n            </div>\n            \n            <div class=\"text-sm text-gray-500 dark:text-gray-400\">\n              <span class=\"text-xs mr-1 uppercase tracking-wider\">Odómetro:</span>\n              <span class=\"font-bold text-gray-700 dark:text-gray-200\">{{ formatOdometro(item.odometro) }} Km</span>\n            </div>\n          </div>\n          \n          <div class=\"flex flex-col items-center justify-center flex-shrink-0 w-full md:w-auto mt-4 lg:mt-0 px-4 lg:px-8\">\n            <img v-if=\"item.estado === 'OK'\" src=\"https://sinergygroup.cl/Mantenciones/img/verde.png\" alt=\"Al Día\"\n              class=\"w-12 h-auto object-contain transition-all duration-300\" />\n            <img v-else-if=\"item.estado === 'Próxima mantención'\" src=\"https://sinergygroup.cl/Mantenciones/img/amarillo.png\"\n              alt=\"Próxima mantención\" class=\"w-12 h-auto object-contain transition-all duration-300\" />\n            <img v-else-if=\"item.estado === 'Requiere mantención'\" src=\"https://sinergygroup.cl/Mantenciones/img/rojo.png\"\n              alt=\"Mantención vencida\" class=\"w-12 h-auto object-contain transition-all duration-300\" />\n            <span v-else class=\"text-gray-500 text-xs mt-2\">{{ item.estado }}</span>\n          </div>\n\n          <div class=\"flex gap-3 pt-2 w-full lg:w-auto lg:flex-col justify-end flex-shrink-0 min-w-[160px]\">\n            <button @click=\"$emit('ver-mantenciones', item)\"\n              class=\"flex-1 flex items-center justify-center gap-1 px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium transition duration-150 shadow-md hover:shadow-lg\">\n              <SvgIcon name=\"eye\" class=\"w-4 h-4\" /> <span class=\"hidden sm:inline lg:hidden xl:inline\">Ver Historial</span>\n              <span class=\"sm:hidden lg:inline xl:hidden\">Historial</span>\n            </button>\n\n            <button @click=\"$emit('agregar-mantencion', item)\"\n              class=\"flex-1 flex items-center justify-center gap-1 px-3 py-2 rounded-lg bg-[#ff6600] hover:bg-[#e65500] text-white text-sm font-medium transition duration-150 shadow-md hover:shadow-lg\">\n              <SvgIcon name=\"plus\" class=\"w-4 h-4\" /> <span class=\"hidden sm:inline lg:hidden xl:inline\">Agregar Mantención</span>\n              <span class=\"sm:hidden lg:inline xl:hidden\">Agregar</span>\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div v-if=\"filteredData.length === 0\" class=\"text-center py-6 text-gray-500 dark:text-gray-400 border border-dashed rounded-lg\">\n        No se encontraron vehículos que coincidan con la búsqueda.\n      </div>\n    </div>\n\n\n    <div\n      class=\"flex flex-col sm:flex-row justify-between items-center mt-5 text-xs sm:text-sm text-gray-700 dark:text-gray-300 gap-2 bg-[#f3f3f3] dark:bg-gray-800 p-3 rounded-xl shadow-inner border border-gray-200 dark:border-gray-700\">\n      <div class=\"flex items-center gap-2\">\n        <label for=\"rowsPerPage\" class=\"text-xs font-medium\">Mostrar:</label>\n        <select id=\"rowsPerPage\" v-model.number=\"rowsPerPage\"\n          class=\"border dark:border-gray-600 rounded-lg px-2 py-1 text-xs sm:text-sm bg-white dark:bg-gray-700 focus:ring-1 focus:ring-[#ff6600]\">\n          <option v-for=\"n in [5, 10, 25, 50, 100]\" :key=\"n\" :value=\"n\">{{ n }}</option>\n        </select>\n        <span class=\"text-gray-500 dark:text-gray-400\">registros por página</span>\n      </div>\n\n      <div class=\"flex items-center gap-1 sm:gap-2\">\n        <button @click=\"goToPage(currentPage - 1)\" :disabled=\"currentPage === 1\"\n          class=\"flex items-center justify-center w-8 h-8 rounded-full border border-gray-400 dark:border-gray-600 disabled:opacity-40 hover:bg-[#ff6600] hover:text-white transition duration-150 ease-in-out\"\n          aria-label=\"Página anterior\">\n          <SvgIcon name=\"chevron-left\" class=\"w-4 h-4\" />\n        </button>\n\n        <span class=\"px-2 font-medium\">Página {{ currentPage }} de {{ totalPages }}</span>\n\n        <button @click=\"goToPage(currentPage + 1)\" :disabled=\"currentPage === totalPages\"\n          class=\"flex items-center justify-center w-8 h-8 rounded-full border border-gray-400 dark:border-gray-600 disabled:opacity-40 hover:bg-[#ff6600] hover:text-white transition duration-150 ease-in-out\"\n          aria-label=\"Página siguiente\">\n          <SvgIcon name=\"chevron-right\" class=\"w-4 h-4\" />\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n### Script (Logic)\n\n```javascript\n<script>\nimport SvgIcon from '@/components/icons/SvgIcon.vue'\n\nexport default {\n  name: \"MantencionesCards\",\n  components: { SvgIcon },\n  props: { mantenciones: { type: Array, default: () => [] } },\n  data() {\n    return {\n      search: \"\",\n      debouncedSearch: \"\",\n      currentPage: 1,\n      rowsPerPage: 5,\n    };\n  },\n  computed: {\n    filteredData() {\n      if (!this.debouncedSearch) return this.mantenciones;\n      return this.mantenciones.filter((item) =>\n        item.patente.toLowerCase().includes(this.debouncedSearch)\n      );\n    },\n    totalPages() {\n      return Math.max(1, Math.ceil(this.filteredData.length / this.rowsPerPage));\n    },\n    paginatedData() {\n      const start = (this.currentPage - 1) * this.rowsPerPage;\n      return this.filteredData.slice(start, start + this.rowsPerPage);\n    },\n    totalVerde() {\n      return this.mantenciones.filter(m => m.estado === 'OK').length;\n    },\n    totalAmarillo() {\n      return this.mantenciones.filter(m => m.estado === 'Próxima mantención').length;\n    },\n    totalRojo() {\n      return this.mantenciones.filter(m => m.estado === 'Requiere mantención').length;\n    }\n  },\n  watch: {\n    search(val) {\n      clearTimeout(this._debounceTimeout);\n      this._debounceTimeout = setTimeout(() => {\n        this.debouncedSearch = val.trim().toLowerCase();\n        this.currentPage = 1;\n      }, 300);\n    },\n    filteredData() {\n      if (this.currentPage > this.totalPages) {\n        this.currentPage = 1;\n      }\n    }\n  },\n  methods: {\n    goToPage(page) {\n      if (page >= 1 && page <= this.totalPages) this.currentPage = page;\n    },\n    formatOdometro(valor) {\n      // Formato con separador de miles y dos decimales\n      const num = parseFloat(valor);\n      return isNaN(num) ? '0.00' : num.toLocaleString('es-CL', { minimumFractionDigits: 2, maximumFractionDigits: 2 });\n    },\n    clearSearch() {\n      this.search = \"\";\n      this.debouncedSearch = \"\";\n    },\n  },\n};\n</script>\n\n### Style (CSS)\n\n```css\n<style scoped>\n.mini-kpi {\n  /* Estilo Sutil: Eliminamos sombra y borde. Usamos un padding más pequeño. */\n  @apply flex flex-col items-center justify-center \n         rounded-lg px-4 py-2 \n         text-center \n         transition duration-200; /* Transición suave sin el hover:shadow-xl */\n  min-width: 90px; \n}\n\n/* Colores de Fondo y Texto Sutiles, basados en la paleta de alertas */\n.kpi-green {\n  /* Fondo muy claro, borde suave (opcional), texto del color primario */\n  @apply bg-emerald-50 dark:bg-gray-700 border border-emerald-200 dark:border-emerald-600 text-emerald-700 dark:text-emerald-400;\n}\n\n.kpi-yellow {\n  @apply bg-amber-50 dark:bg-gray-700 border border-amber-200 dark:border-amber-600 text-amber-700 dark:text-amber-400;\n}\n\n.kpi-red {\n  @apply bg-red-50 dark:bg-gray-700 border border-red-200 dark:border-red-600 text-red-700 dark:text-red-400;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}