{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { ref } from 'vue';\nimport MantencionesTable from '@/components/MantencionesUi/MantencionesTable.vue';\nimport ModalAgregar from '@/components/MantencionesUi/ModalAgregar.vue';\nimport ModalVerMantenciones from '@/components/MantencionesUi/ModalVerMantenciones.vue';\n\n// Lista general de veh√≠culos\n\nexport default {\n  __name: 'MantencionesView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const mantenciones = ref([{\n      patente: 'ABC123',\n      odometro: 4500,\n      estado: 'OK',\n      registros: []\n    }, {\n      patente: 'XYZ789',\n      odometro: 72000,\n      estado: 'Requiere mantenci√≥n',\n      registros: []\n    }, {\n      patente: 'DEF456',\n      odometro: 60000,\n      estado: 'Pr√≥xima mantenci√≥n',\n      registros: []\n    }]);\n    const patenteSeleccionada = ref('');\n    const selectedVehiculo = ref(null);\n    const showAddModal = ref(false);\n    const showViewModal = ref(false);\n\n    // üîπ Abrir modal para agregar\n    function abrirModal(item) {\n      selectedVehiculo.value = item;\n      patenteSeleccionada.value = item.patente;\n      showAddModal.value = true;\n    }\n\n    // üîπ Guardar mantenci√≥n agregada\n    function guardarMantencion(data) {\n      const vehiculo = mantenciones.value.find(v => v.patente === patenteSeleccionada.value);\n      if (!vehiculo) return;\n      const ahora = new Date();\n      const fechaCreacion = ahora.toLocaleString('es-CL');\n\n      // Calcular umbral y faltante\n      let umbral, faltante;\n      if (data.type === 'Por Od√≥metro') {\n        umbral = Number(data.km) + Number(data.intervalo);\n        faltante = umbral - vehiculo.odometro;\n      } else {\n        const ultima = new Date(data.fechaUltima);\n        const intervaloDias = Number(data.intervalo);\n        const fechaUmbral = new Date(ultima);\n        fechaUmbral.setDate(ultima.getDate() + intervaloDias);\n        umbral = fechaUmbral.toLocaleDateString('es-CL');\n        const diffMs = fechaUmbral - ahora;\n        faltante = Math.ceil(diffMs / (1000 * 60 * 60 * 24));\n      }\n      const nuevo = {\n        nombre: data.name,\n        tipo: data.type,\n        intervalo: data.intervalo,\n        ultimo: data.type === 'Por Od√≥metro' ? data.km : data.fechaUltima,\n        umbral,\n        actual: data.type === 'Por Od√≥metro' ? vehiculo.odometro : new Date().toLocaleDateString('es-CL'),\n        faltante,\n        fechaCreacion,\n        estado: definirEstado(faltante, data.type)\n      };\n      vehiculo.registros.push(nuevo);\n      showAddModal.value = false;\n    }\n\n    // üîπ Estado seg√∫n distancia o d√≠as faltantes\n    function definirEstado(faltante, tipo) {\n      if (tipo === 'Por Od√≥metro') {\n        if (faltante <= 0) return 'Requiere mantenci√≥n';\n        if (faltante <= 500) return 'Pr√≥xima mantenci√≥n';\n        return 'OK';\n      } else {\n        if (faltante <= 0) return 'Requiere mantenci√≥n';\n        if (faltante <= 7) return 'Pr√≥xima mantenci√≥n';\n        return 'OK';\n      }\n    }\n\n    // üîπ Abrir modal de ver\n    function verMantenciones(item) {\n      selectedVehiculo.value = item;\n      patenteSeleccionada.value = item.patente;\n      showViewModal.value = true;\n    }\n    function cerrarModal() {\n      showAddModal.value = false;\n    }\n    function cerrarVerModal() {\n      showViewModal.value = false;\n    }\n\n    // üîπ Mantenciones espec√≠ficas del veh√≠culo\n    const mantencionesVehiculoSeleccionado = computed(() => {\n      return selectedVehiculo.value?.registros || [];\n    });\n    const __returned__ = {\n      mantenciones,\n      patenteSeleccionada,\n      selectedVehiculo,\n      showAddModal,\n      showViewModal,\n      abrirModal,\n      guardarMantencion,\n      definirEstado,\n      verMantenciones,\n      cerrarModal,\n      cerrarVerModal,\n      mantencionesVehiculoSeleccionado,\n      ref,\n      MantencionesTable,\n      ModalAgregar,\n      ModalVerMantenciones\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","MantencionesTable","ModalAgregar","ModalVerMantenciones","mantenciones","patente","odometro","estado","registros","patenteSeleccionada","selectedVehiculo","showAddModal","showViewModal","abrirModal","item","value","guardarMantencion","data","vehiculo","find","v","ahora","Date","fechaCreacion","toLocaleString","umbral","faltante","type","Number","km","intervalo","ultima","fechaUltima","intervaloDias","fechaUmbral","setDate","getDate","toLocaleDateString","diffMs","Math","ceil","nuevo","nombre","name","tipo","ultimo","actual","definirEstado","push","verMantenciones","cerrarModal","cerrarVerModal","mantencionesVehiculoSeleccionado","computed"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/Views/MantencionesView.vue"],"sourcesContent":["<template>\n  <div class=\"p-2\">\n    <!-- üßæ Tabla -->\n    <MantencionesTable \n      :mantenciones=\"mantenciones\" \n      @ver-mantenciones=\"verMantenciones\"\n      @agregar-mantencion=\"abrirModal\" \n    />\n\n    <!-- ü™ü Modal Agregar -->\n    <ModalAgregar \n      v-if=\"showAddModal\" \n      :show-add-modal=\"showAddModal\"\n      :selected-patente=\"patenteSeleccionada\"\n      @close=\"cerrarModal\"\n      @save=\"guardarMantencion\" \n    />\n\n    <!-- üëÅÔ∏è Modal Ver -->\n    <ModalVerMantenciones\n      v-if=\"showViewModal\"\n      :mantenciones=\"mantencionesVehiculoSeleccionado\"\n      :patente=\"patenteSeleccionada\"\n      @close=\"cerrarVerModal\"\n    />\n  </div>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport MantencionesTable from '@/components/MantencionesUi/MantencionesTable.vue'\nimport ModalAgregar from '@/components/MantencionesUi/ModalAgregar.vue'\nimport ModalVerMantenciones from '@/components/MantencionesUi/ModalVerMantenciones.vue'\n\n// Lista general de veh√≠culos\nconst mantenciones = ref([\n  { patente: 'ABC123', odometro: 4500, estado: 'OK', registros: [] },\n  { patente: 'XYZ789', odometro: 72000, estado: 'Requiere mantenci√≥n', registros: [] },\n  { patente: 'DEF456', odometro: 60000, estado: 'Pr√≥xima mantenci√≥n', registros: [] },\n])\n\nconst patenteSeleccionada = ref('')\nconst selectedVehiculo = ref(null)\nconst showAddModal = ref(false)\nconst showViewModal = ref(false)\n\n// üîπ Abrir modal para agregar\nfunction abrirModal(item) {\n  selectedVehiculo.value = item\n  patenteSeleccionada.value = item.patente\n  showAddModal.value = true\n}\n\n// üîπ Guardar mantenci√≥n agregada\nfunction guardarMantencion(data) {\n  const vehiculo = mantenciones.value.find(v => v.patente === patenteSeleccionada.value)\n  if (!vehiculo) return\n\n  const ahora = new Date()\n  const fechaCreacion = ahora.toLocaleString('es-CL')\n\n  // Calcular umbral y faltante\n  let umbral, faltante\n  if (data.type === 'Por Od√≥metro') {\n    umbral = Number(data.km) + Number(data.intervalo)\n    faltante = umbral - vehiculo.odometro\n  } else {\n    const ultima = new Date(data.fechaUltima)\n    const intervaloDias = Number(data.intervalo)\n    const fechaUmbral = new Date(ultima)\n    fechaUmbral.setDate(ultima.getDate() + intervaloDias)\n    umbral = fechaUmbral.toLocaleDateString('es-CL')\n    const diffMs = fechaUmbral - ahora\n    faltante = Math.ceil(diffMs / (1000 * 60 * 60 * 24))\n  }\n\n  const nuevo = {\n    nombre: data.name,\n    tipo: data.type,\n    intervalo: data.intervalo,\n    ultimo: data.type === 'Por Od√≥metro' ? data.km : data.fechaUltima,\n    umbral,\n    actual: data.type === 'Por Od√≥metro' ? vehiculo.odometro : new Date().toLocaleDateString('es-CL'),\n    faltante,\n    fechaCreacion,\n    estado: definirEstado(faltante, data.type),\n  }\n\n  vehiculo.registros.push(nuevo)\n  showAddModal.value = false\n}\n\n// üîπ Estado seg√∫n distancia o d√≠as faltantes\nfunction definirEstado(faltante, tipo) {\n  if (tipo === 'Por Od√≥metro') {\n    if (faltante <= 0) return 'Requiere mantenci√≥n'\n    if (faltante <= 500) return 'Pr√≥xima mantenci√≥n'\n    return 'OK'\n  } else {\n    if (faltante <= 0) return 'Requiere mantenci√≥n'\n    if (faltante <= 7) return 'Pr√≥xima mantenci√≥n'\n    return 'OK'\n  }\n}\n\n// üîπ Abrir modal de ver\nfunction verMantenciones(item) {\n  selectedVehiculo.value = item\n  patenteSeleccionada.value = item.patente\n  showViewModal.value = true\n}\n\nfunction cerrarModal() {\n  showAddModal.value = false\n}\n\nfunction cerrarVerModal() {\n  showViewModal.value = false\n}\n\n// üîπ Mantenciones espec√≠ficas del veh√≠culo\nconst mantencionesVehiculoSeleccionado = computed(() => {\n  return selectedVehiculo.value?.registros || []\n})\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}