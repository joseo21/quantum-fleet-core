{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport SvgIcon from '@/components/icons/SvgIcon.vue';\nimport { ref, computed } from 'vue';\nexport default {\n  __name: 'AgregarEmpresasModal',\n  props: {\n    show: Boolean,\n    templates: Array\n  },\n  emits: ['add-company', 'close'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const emit = __emit;\n    const step = ref(1);\n    const selectedTemplate = ref(null);\n    const newCompany = ref({\n      name: '',\n      rut: '',\n      contact: '',\n      city: ''\n    });\n\n    // Validación RUT chileno\n    const isValidRut = rut => /^(\\d{1,2}\\.\\d{3}\\.\\d{3}-[\\dkK])$/.test(rut);\n\n    // Formateo RUT\n    const formatRut = company => {\n      let rut = company.rut.replace(/[^0-9kK]/g, '');\n      if (rut.length > 9) rut = rut.slice(0, 9);\n      if (rut.length > 1) {\n        const body = rut.slice(0, -1);\n        const dv = rut.slice(-1);\n        const reversed = body.split('').reverse();\n        const withDots = [];\n        reversed.forEach((char, i) => {\n          if (i > 0 && i % 3 === 0) withDots.push('.');\n          withDots.push(char);\n        });\n        company.rut = withDots.reverse().join('') + '-' + dv;\n      } else company.rut = rut;\n    };\n\n    // Validación paso 1\n    const isStep1Valid = computed(() => {\n      const {\n        name,\n        rut,\n        contact,\n        city\n      } = newCompany.value;\n      return name.trim() && rut.trim() && contact.trim() && city.trim() && isValidRut(rut);\n    });\n\n    // Botón siguiente\n    const goToNextStep = () => {\n      if (isStep1Valid.value) step.value = 2;else alert('Completa todos los campos correctamente antes de continuar.');\n    };\n\n    // Cancelar modal\n    const cancel = () => {\n      step.value = 1;\n      selectedTemplate.value = null;\n      newCompany.value = {\n        name: '',\n        rut: '',\n        contact: '',\n        city: ''\n      };\n      emit('close');\n    };\n\n    // Agregar empresa\n    const isModalButtonDisabled = computed(() => !selectedTemplate.value);\n    const addCompany = () => {\n      if (!selectedTemplate.value) return;\n      if (!isValidRut(newCompany.value.rut)) {\n        alert('RUT inválido. Formato esperado: xx.xxx.xxx-x');\n        return;\n      }\n      emit('add-company', {\n        ...newCompany.value,\n        templateId: selectedTemplate.value\n      });\n      cancel();\n    };\n    const __returned__ = {\n      props,\n      emit,\n      step,\n      selectedTemplate,\n      newCompany,\n      isValidRut,\n      formatRut,\n      isStep1Valid,\n      goToNextStep,\n      cancel,\n      isModalButtonDisabled,\n      addCompany,\n      SvgIcon,\n      ref,\n      computed\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["SvgIcon","ref","computed","props","__props","emit","__emit","step","selectedTemplate","newCompany","name","rut","contact","city","isValidRut","test","formatRut","company","replace","length","slice","body","dv","reversed","split","reverse","withDots","forEach","char","i","push","join","isStep1Valid","value","trim","goToNextStep","alert","cancel","isModalButtonDisabled","addCompany","templateId"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/components/EmpresasUi/AgregarEmpresasModal.vue"],"sourcesContent":["<template>\n  <div v-if=\"show\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n    <div\n      class=\"bg-white dark:bg-gray-900 text-gray-900 dark:text-white rounded-lg relative flex flex-col w-full max-w-lg h-auto p-6 border border-gray-300 dark:border-gray-700 shadow-xl\">\n\n      <button v-if=\"step === 2\" @click=\"step = 1\"\n        class=\"absolute top-4 left-4 p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-800 transition\" title=\"Volver\">\n        <SvgIcon name=\"arrow-left\" class=\"w-6 h-6\" />\n      </button>\n\n      <h2 class=\"text-2xl font-bold mb-4 text-center text-[#102372] dark:text-[#ff6600]\">\n        {{ step === 1 ? 'Agregar Empresa' : 'Seleccionar Template' }}\n      </h2>\n\n      <span class=\"h-px bg-gray-300 dark:bg-gray-700 mb-4\"></span>\n\n      <!-- Paso 1 -->\n      <form v-if=\"step === 1\" @submit.prevent=\"goToNextStep\" class=\"flex-1 flex flex-col gap-3 py-2 overflow-y-auto\">\n        <input v-model=\"newCompany.name\" type=\"text\" placeholder=\"Nombre de la empresa\"\n          class=\"px-3 py-2 rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none\"\n          required />\n\n        <input v-model=\"newCompany.rut\" type=\"text\" placeholder=\"RUT de la empresa\"\n          class=\"px-3 py-2 rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none\"\n          required @input=\"formatRut(newCompany)\" />\n\n        <input v-model=\"newCompany.contact\" type=\"text\" placeholder=\"Contacto\"\n          class=\"px-3 py-2 rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none\"\n          required />\n\n        <input v-model=\"newCompany.city\" type=\"text\" placeholder=\"Ciudad de la empresa\"\n          class=\"px-3 py-2 rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none\"\n          required />\n      </form>\n\n      <!-- Paso 2 -->\n      <div v-else class=\"grid grid-cols-1 sm:grid-cols-2 gap-4 py-4\">\n        <div v-for=\"template in templates\" :key=\"template.id\" @click=\"selectedTemplate = template.id\" :class=\"[\n          'p-6 rounded-lg border cursor-pointer text-center transition',\n          selectedTemplate === template.id\n            ? 'border-[#ff6600] bg-orange-100 dark:bg-[#e65500]/30'\n            : 'border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800'\n        ]\">\n          <h3 class=\"text-lg font-semibold mb-2\">{{ template.name }}</h3>\n          <p class=\"text-gray-500 dark:text-gray-400 text-sm\">{{ template.description }}</p>\n        </div>\n      </div>\n\n      <!-- Botones -->\n      <div class=\"flex justify-between mt-6\">\n        <button @click=\"cancel\" class=\"bg-gray-500 hover:bg-gray-600 px-4 py-2 rounded w-[48%] text-white\">\n          Cancelar\n        </button>\n\n        <button v-if=\"step === 1\" @click=\"goToNextStep\" :disabled=\"!isStep1Valid\"\n          :class=\"['px-4 py-2 rounded w-[48%] text-white font-medium', isStep1Valid ? 'bg-[#102372] hover:bg-[#0c1a5b]' : 'bg-[#102372]/50 cursor-not-allowed']\">\n          Siguiente\n        </button>\n\n        <button v-else @click=\"addCompany\" :disabled=\"isModalButtonDisabled\"\n          :class=\"['px-4 py-2 rounded w-[48%] text-white font-medium', isModalButtonDisabled ? 'bg-[#ff6600]/50 cursor-not-allowed' : 'bg-[#ff6600] hover:bg-[#e65500]']\">\n          Crear Empresa\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport SvgIcon from '@/components/icons/SvgIcon.vue'\nimport { ref, computed } from 'vue'\n\nconst props = defineProps({\n  show: Boolean,\n  templates: Array\n})\n\nconst emit = defineEmits(['add-company', 'close'])\n\nconst step = ref(1)\nconst selectedTemplate = ref(null)\nconst newCompany = ref({ name: '', rut: '', contact: '', city: '' })\n\n// Validación RUT chileno\nconst isValidRut = (rut) => /^(\\d{1,2}\\.\\d{3}\\.\\d{3}-[\\dkK])$/.test(rut)\n\n// Formateo RUT\nconst formatRut = (company) => {\n  let rut = company.rut.replace(/[^0-9kK]/g, '')\n  if (rut.length > 9) rut = rut.slice(0, 9)\n  if (rut.length > 1) {\n    const body = rut.slice(0, -1)\n    const dv = rut.slice(-1)\n    const reversed = body.split('').reverse()\n    const withDots = []\n    reversed.forEach((char, i) => { if (i > 0 && i % 3 === 0) withDots.push('.'); withDots.push(char) })\n    company.rut = withDots.reverse().join('') + '-' + dv\n  } else company.rut = rut\n}\n\n// Validación paso 1\nconst isStep1Valid = computed(() => {\n  const { name, rut, contact, city } = newCompany.value\n  return name.trim() && rut.trim() && contact.trim() && city.trim() && isValidRut(rut)\n})\n\n// Botón siguiente\nconst goToNextStep = () => {\n  if (isStep1Valid.value) step.value = 2\n  else alert('Completa todos los campos correctamente antes de continuar.')\n}\n\n// Cancelar modal\nconst cancel = () => {\n  step.value = 1\n  selectedTemplate.value = null\n  newCompany.value = { name: '', rut: '', contact: '', city: '' }\n  emit('close')\n}\n\n// Agregar empresa\nconst isModalButtonDisabled = computed(() => !selectedTemplate.value)\nconst addCompany = () => {\n  if (!selectedTemplate.value) return\n  if (!isValidRut(newCompany.value.rut)) {\n    alert('RUT inválido. Formato esperado: xx.xxx.xxx-x')\n    return\n  }\n  emit('add-company', { ...newCompany.value, templateId: selectedTemplate.value })\n  cancel()\n}\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}