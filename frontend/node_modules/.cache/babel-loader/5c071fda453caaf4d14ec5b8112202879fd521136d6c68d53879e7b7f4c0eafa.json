{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"p-2\"\n};\nexport function render(_ctx, _cache) {\n  const _component_MantencionesTable = _resolveComponent(\"MantencionesTable\");\n  const _component_ModalAgregar = _resolveComponent(\"ModalAgregar\");\n  const _component_ModalVerMantenciones = _resolveComponent(\"ModalVerMantenciones\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_MantencionesTable, {\n    mantenciones: _ctx.mantenciones,\n    onVerMantenciones: _ctx.verMantenciones,\n    onAgregarMantencion: _ctx.abrirModal\n  }, null, 8 /* PROPS */, [\"mantenciones\", \"onVerMantenciones\", \"onAgregarMantencion\"]), _ctx.showAddModal ? (_openBlock(), _createBlock(_component_ModalAgregar, {\n    key: 0,\n    \"show-add-modal\": _ctx.showAddModal,\n    \"selected-patente\": _ctx.patenteSeleccionada,\n    mantenciones: _ctx.mantencionesPorPatente[_ctx.patenteSeleccionada] || [],\n    \"selected-mantencion\": _ctx.mantencionSeleccionada,\n    templates: _ctx.templates,\n    onClose: _ctx.cerrarModal,\n    onSave: _ctx.guardarMantencion\n  }, null, 8 /* PROPS */, [\"show-add-modal\", \"selected-patente\", \"mantenciones\", \"selected-mantencion\", \"templates\", \"onClose\", \"onSave\"])) : _createCommentVNode(\"v-if\", true), _ctx.showVerModal ? (_openBlock(), _createBlock(_component_ModalVerMantenciones, {\n    key: 1,\n    patente: _ctx.patenteSeleccionada,\n    mantenciones: _ctx.mantencionesPorPatente[_ctx.patenteSeleccionada] || [],\n    onClose: _cache[0] || (_cache[0] = $event => _ctx.showVerModal = false),\n    onEditar: _ctx.editarMantencion,\n    onEliminar: _ctx.eliminarMantencion\n  }, null, 8 /* PROPS */, [\"patente\", \"mantenciones\", \"onEditar\", \"onEliminar\"])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_MantencionesTable","mantenciones","_ctx","onVerMantenciones","verMantenciones","onAgregarMantencion","abrirModal","showAddModal","_createBlock","_component_ModalAgregar","patenteSeleccionada","mantencionesPorPatente","mantencionSeleccionada","templates","onClose","cerrarModal","onSave","guardarMantencion","showVerModal","_component_ModalVerMantenciones","patente","_cache","$event","onEditar","editarMantencion","onEliminar","eliminarMantencion"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/Views/MantencionesView.vue"],"sourcesContent":["<template>\n  <div class=\"p-2\">\n    <MantencionesTable :mantenciones=\"mantenciones\" @ver-mantenciones=\"verMantenciones\"\n      @agregar-mantencion=\"abrirModal\" />\n\n    <ModalAgregar v-if=\"showAddModal\" :show-add-modal=\"showAddModal\" :selected-patente=\"patenteSeleccionada\"\n      :mantenciones=\"mantencionesPorPatente[patenteSeleccionada] || []\" :selected-mantencion=\"mantencionSeleccionada\"\n      :templates=\"templates\" @close=\"cerrarModal\" @save=\"guardarMantencion\" />\n\n    <ModalVerMantenciones v-if=\"showVerModal\" :patente=\"patenteSeleccionada\"\n      :mantenciones=\"mantencionesPorPatente[patenteSeleccionada] || []\" @close=\"showVerModal = false\"\n      @editar=\"editarMantencion\" @eliminar=\"eliminarMantencion\" />\n\n  </div>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport MantencionesTable from '@/components/MantencionesUi/MantencionesTable.vue'\nimport ModalAgregar from '@/components/MantencionesUi/ModalAgregar.vue'\nimport ModalVerMantenciones from '@/components/MantencionesUi/ModalVerMantenciones.vue'\n\nconst patenteSeleccionada = ref('')\nconst selectedVehiculo = ref(null)\nconst mantencionSeleccionada = ref(null) // Para editar\n\nconst showAddModal = ref(false)\nconst showVerModal = ref(false)\n\n// Mantenciones por patente\nconst mantencionesPorPatente = ref({})\n\n// Lista inicial de vehículos\nconst mantenciones = ref([\n  { patente: 'ABC123', odometro: 4500, estado: 'OK' },\n  { patente: 'XYZ789', odometro: 72000, estado: 'Requiere mantención' },\n  { patente: 'DEF456', odometro: 60000, estado: 'Próxima mantención' },\n])\n\n\nconst templates = ref([\n  { id: 1, name: 'Revisión Tecnica', type: 'Por Tiempo', description: 'Verificación completa del vehículo según normativa', used: false },\n  { id: 2, name: 'Permiso de Circulación', type: 'Por Tiempo', description: 'Gestión y pago del permiso de circulación anual', used: false },\n  { id: 3, name: 'Cambio de Neumáticos', type: 'Por Odómetro', description: 'Rotación, balanceo y revisión del desgaste de neumáticos', used: false },\n  { id: 4, name: 'Cambio de Aceite', type: 'Por Odómetro', description: 'Sustitución de aceite y filtro para mantener motor óptimo', used: false },\n  { id: 5, name: 'Cambio de Filtro de Aire', type: 'Por Odómetro', description: 'Reemplazo del filtro de aire para mejorar eficiencia del motor', used: false },\n])\n\n\nfunction abrirModal(item) {\n  selectedVehiculo.value = item\n  patenteSeleccionada.value = item.patente\n  mantencionSeleccionada.value = null // Nuevo registro\n  showAddModal.value = true\n}\n\nfunction cerrarModal() {\n  showAddModal.value = false\n  selectedVehiculo.value = null\n  mantencionSeleccionada.value = null\n}\n\nfunction verMantenciones(item) {\n  patenteSeleccionada.value = item.patente\n  showVerModal.value = true\n}\n\nguardarMantencion({ nuevaMantencion, templateId }) {\n  const patente = patenteSeleccionada.value;\n  if (!mantencionesPorPatente.value[patente]) mantencionesPorPatente.value[patente] = [];\n\n  if (mantencionSeleccionada.value !== null) {\n    mantencionesPorPatente.value[patente][mantencionSeleccionada.value] = nuevaMantencion;\n  } else {\n    mantencionesPorPatente.value[patente].push(nuevaMantencion);\n\n    // marcar usado de forma reactiva\n    const index = templates.value.findIndex(t => t.id === templateId);\n    if (index !== -1) {\n      templates.value[index] = { ...templates.value[index], used: true };\n    }\n  }\n\n  cerrarModal();\n}\n\n\n// Editar desde ModalVerMantenciones\nfunction editarMantencion(idx) {\n  const patente = patenteSeleccionada.value\n  mantencionSeleccionada.value = idx\n  selectedVehiculo.value = { patente }\n  showAddModal.value = true\n}\n\n// Eliminar desde ModalVerMantenciones\nfunction eliminarMantencion(idx) {\n  const patente = patenteSeleccionada.value\n  mantencionesPorPatente.value[patente].splice(idx, 1)\n}\n</script>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAK;;;;;uBAAhBC,mBAAA,CAYM,OAZNC,UAYM,GAXJC,YAAA,CACqCC,4BAAA;IADjBC,YAAY,EAAEC,IAAA,CAAAD,YAAY;IAAGE,iBAAgB,EAAED,IAAA,CAAAE,eAAe;IAC/EC,mBAAkB,EAAEH,IAAA,CAAAI;yFAEHJ,IAAA,CAAAK,YAAY,I,cAAhCC,YAAA,CAE0EC,uBAAA;;IAFvC,gBAAc,EAAEP,IAAA,CAAAK,YAAY;IAAG,kBAAgB,EAAEL,IAAA,CAAAQ,mBAAmB;IACpGT,YAAY,EAAEC,IAAA,CAAAS,sBAAsB,CAACT,IAAA,CAAAQ,mBAAmB;IAAU,qBAAmB,EAAER,IAAA,CAAAU,sBAAsB;IAC7GC,SAAS,EAAEX,IAAA,CAAAW,SAAS;IAAGC,OAAK,EAAEZ,IAAA,CAAAa,WAAW;IAAGC,MAAI,EAAEd,IAAA,CAAAe;iLAEzBf,IAAA,CAAAgB,YAAY,I,cAAxCV,YAAA,CAE8DW,+BAAA;;IAFnBC,OAAO,EAAElB,IAAA,CAAAQ,mBAAmB;IACpET,YAAY,EAAEC,IAAA,CAAAS,sBAAsB,CAACT,IAAA,CAAAQ,mBAAmB;IAAUI,OAAK,EAAAO,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEpB,IAAA,CAAAgB,YAAY;IACrFK,QAAM,EAAErB,IAAA,CAAAsB,gBAAgB;IAAGC,UAAQ,EAAEvB,IAAA,CAAAwB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}