{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { ref, computed } from 'vue';\nimport EmpresasTable from '@/components/EmpresasUi/EmpresasTable.vue';\nimport AgregarEmpresasModal from '@/components/EmpresasUi/AgregarEmpresasModal.vue';\nimport EditarEmpresasSideBar from '@/components/EmpresasUi/EditarEmpresasSideBar.vue';\nconst DEFAULT_TEMPLATE_ID = 1;\nexport default {\n  __name: 'EmpresasView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const customers = ref([{\n      id: 1,\n      createdAt: '2025-07-30',\n      name: 'Demo Combustible',\n      rut: '76.145.230-9',\n      contact: 'Marcelo Díaz',\n      city: 'Santiago'\n    }, {\n      id: 2,\n      createdAt: '2025-07-23',\n      name: 'Industrial Glover S.P.A.',\n      rut: '77.239.684-2',\n      contact: 'Patricia González',\n      city: 'Lautaro'\n    }\n    // ... resto de empresas\n    ]);\n    const searchTerm = ref('');\n    const rowsPerPageOptions = [5, 10, 20, 50];\n    const rowsPerPage = ref(5);\n    const currentPage = ref(1);\n    const copiedId = ref(null);\n    const showAddModal = ref(false);\n    const step = ref(1);\n    const selectedTemplate = ref(null);\n    const newCompany = ref({\n      name: '',\n      rut: '',\n      contact: '',\n      city: ''\n    });\n    const showEditSidebar = ref(false);\n    const editingCompany = ref({\n      id: null,\n      name: '',\n      rut: '',\n      contact: '',\n      city: '',\n      templateId: DEFAULT_TEMPLATE_ID\n    });\n    const templates = ref([{\n      id: 1,\n      name: 'Básico',\n      description: 'Acceso limitado a reportes y panel general.'\n    }, {\n      id: 2,\n      name: 'Profesional',\n      description: 'Incluye reportes y comentarios.'\n    }, {\n      id: 3,\n      name: 'Avanzado',\n      description: 'Incluye dashboards personalizados y reportes completos.'\n    }, {\n      id: 4,\n      name: 'Full',\n      description: 'Todas las funciones habilitadas.'\n    }]);\n\n    // Validación RUT\n    const isValidRut = rut => /^(\\d{1,2}\\.\\d{3}\\.\\d{3}-[\\dkK])$/.test(rut);\n    const isStep1Valid = computed(() => {\n      const {\n        name,\n        rut,\n        contact,\n        city\n      } = newCompany.value;\n      return name.trim() && rut.trim() && contact.trim() && city.trim() && isValidRut(rut);\n    });\n\n    // Funciones\n    const goToNextStep = () => {\n      if (isStep1Valid.value) step.value = 2;\n    };\n    const cancel = () => {\n      showAddModal.value = false;\n      step.value = 1;\n      selectedTemplate.value = null;\n      newCompany.value = {\n        name: '',\n        rut: '',\n        contact: '',\n        city: ''\n      };\n    };\n    const addCompany = () => {\n      if (!selectedTemplate.value) return;\n      if (!isValidRut(newCompany.value.rut)) {\n        alert('RUT inválido');\n        return;\n      }\n      const id = Date.now();\n      const createdAt = new Date().toISOString().slice(0, 10);\n      customers.value.push({\n        id,\n        createdAt,\n        ...newCompany.value,\n        templateId: selectedTemplate.value\n      });\n      cancel();\n    };\n    const editCustomer = customer => {\n      editingCompany.value = {\n        ...customer\n      };\n      if (!editingCompany.value.templateId) editingCompany.value.templateId = DEFAULT_TEMPLATE_ID;\n      showEditSidebar.value = true;\n    };\n    const updateCompany = () => {\n      if (!isValidRut(editingCompany.value.rut)) {\n        alert('RUT inválido');\n        return;\n      }\n      const index = customers.value.findIndex(c => c.id === editingCompany.value.id);\n      if (index !== -1) customers.value[index] = {\n        ...editingCompany.value\n      };\n      showEditSidebar.value = false;\n    };\n    const deleteSelected = ids => {\n      customers.value = customers.value.filter(c => !ids.includes(c.id));\n    };\n    const copyCustomerData = customer => {\n      const data = `Nombre: ${customer.name}\\nRUT: ${customer.rut}\\nContacto: ${customer.contact}`;\n      navigator.clipboard.writeText(data).then(() => {\n        copiedId.value = customer.id;\n        setTimeout(() => copiedId.value = null, 1000);\n      });\n    };\n    const __returned__ = {\n      DEFAULT_TEMPLATE_ID,\n      customers,\n      searchTerm,\n      rowsPerPageOptions,\n      rowsPerPage,\n      currentPage,\n      copiedId,\n      showAddModal,\n      step,\n      selectedTemplate,\n      newCompany,\n      showEditSidebar,\n      editingCompany,\n      templates,\n      isValidRut,\n      isStep1Valid,\n      goToNextStep,\n      cancel,\n      addCompany,\n      editCustomer,\n      updateCompany,\n      deleteSelected,\n      copyCustomerData,\n      ref,\n      computed,\n      EmpresasTable,\n      AgregarEmpresasModal,\n      EditarEmpresasSideBar\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","EmpresasTable","AgregarEmpresasModal","EditarEmpresasSideBar","DEFAULT_TEMPLATE_ID","customers","id","createdAt","name","rut","contact","city","searchTerm","rowsPerPageOptions","rowsPerPage","currentPage","copiedId","showAddModal","step","selectedTemplate","newCompany","showEditSidebar","editingCompany","templateId","templates","description","isValidRut","test","isStep1Valid","value","trim","goToNextStep","cancel","addCompany","alert","Date","now","toISOString","slice","push","editCustomer","customer","updateCompany","index","findIndex","c","deleteSelected","ids","filter","includes","copyCustomerData","data","navigator","clipboard","writeText","then","setTimeout"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/Views/EmpresasView.vue"],"sourcesContent":["<template>\n  <div class=\"p-2 sm:p-4 w-full flex flex-col\">\n    <!-- Tabla -->\n    <EmpresasTable\n      :customers=\"customers\"\n      :search-term=\"searchTerm\"\n      :rows-per-page=\"rowsPerPage\"\n      :rows-per-page-options=\"rowsPerPageOptions\"\n      :current-page=\"currentPage\"\n      :copied-id=\"copiedId\"\n      @update:searchTerm=\"searchTerm = $event\"\n      @update:rowsPerPage=\"rowsPerPage = Number($event)\"\n      @update:currentPage=\"currentPage = $event\"\n      @edit-customer=\"editCustomer\"\n      @copy-customer=\"copyCustomerData\"\n      @delete-selected=\"deleteSelected\"\n    />\n\n    <!-- Modal Agregar -->\n    <AgregarEmpresasModal\n      v-if=\"showAddModal\"\n      :show=\"showAddModal\"\n      :step=\"step\"\n      :new-company=\"newCompany\"\n      :templates=\"templates\"\n      :selected-template=\"selectedTemplate\"\n      :is-step1-valid=\"isStep1Valid\"\n      @update:newCompany=\"newCompany = $event\"\n      @update:selectedTemplate=\"selectedTemplate = $event\"\n      @update:step=\"step = $event\"\n      @go-to-next-step=\"goToNextStep\"\n      @add-company=\"addCompany\"\n      @cancel=\"cancel\"\n    />\n\n    <!-- Sidebar Editar -->\n    <EditarEmpresasSideBar\n      v-if=\"showEditSidebar\"\n      :editing-company=\"editingCompany\"\n      :templates=\"templates\"\n      @update-company=\"updateCompany\"\n      @close-sidebar=\"showEditSidebar = false\"\n    />\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue'\nimport EmpresasTable from '@/components/EmpresasUi/EmpresasTable.vue'\nimport AgregarEmpresasModal from '@/components/EmpresasUi/AgregarEmpresasModal.vue'\nimport EditarEmpresasSideBar from '@/components/EmpresasUi/EditarEmpresasSideBar.vue'\n\nconst DEFAULT_TEMPLATE_ID = 1\n\nconst customers = ref([\n  { id: 1, createdAt: '2025-07-30', name: 'Demo Combustible', rut: '76.145.230-9', contact: 'Marcelo Díaz', city: 'Santiago' },\n  { id: 2, createdAt: '2025-07-23', name: 'Industrial Glover S.P.A.', rut: '77.239.684-2', contact: 'Patricia González', city: 'Lautaro' },\n  // ... resto de empresas\n])\n\nconst searchTerm = ref('')\nconst rowsPerPageOptions = [5, 10, 20, 50]\nconst rowsPerPage = ref(5)\nconst currentPage = ref(1)\nconst copiedId = ref(null)\n\nconst showAddModal = ref(false)\nconst step = ref(1)\nconst selectedTemplate = ref(null)\nconst newCompany = ref({ name: '', rut: '', contact: '', city: '' })\n\nconst showEditSidebar = ref(false)\nconst editingCompany = ref({ id: null, name: '', rut: '', contact: '', city: '', templateId: DEFAULT_TEMPLATE_ID })\n\nconst templates = ref([\n  { id: 1, name: 'Básico', description: 'Acceso limitado a reportes y panel general.' },\n  { id: 2, name: 'Profesional', description: 'Incluye reportes y comentarios.' },\n  { id: 3, name: 'Avanzado', description: 'Incluye dashboards personalizados y reportes completos.' },\n  { id: 4, name: 'Full', description: 'Todas las funciones habilitadas.' }\n])\n\n// Validación RUT\nconst isValidRut = (rut) => /^(\\d{1,2}\\.\\d{3}\\.\\d{3}-[\\dkK])$/.test(rut)\nconst isStep1Valid = computed(() => {\n  const { name, rut, contact, city } = newCompany.value\n  return name.trim() && rut.trim() && contact.trim() && city.trim() && isValidRut(rut)\n})\n\n// Funciones\nconst goToNextStep = () => { if (isStep1Valid.value) step.value = 2 }\n\nconst cancel = () => {\n  showAddModal.value = false\n  step.value = 1\n  selectedTemplate.value = null\n  newCompany.value = { name: '', rut: '', contact: '', city: '' }\n}\n\nconst addCompany = () => {\n  if (!selectedTemplate.value) return\n  if (!isValidRut(newCompany.value.rut)) {\n    alert('RUT inválido')\n    return\n  }\n  const id = Date.now()\n  const createdAt = new Date().toISOString().slice(0, 10)\n  customers.value.push({ id, createdAt, ...newCompany.value, templateId: selectedTemplate.value })\n  cancel()\n}\n\nconst editCustomer = (customer) => {\n  editingCompany.value = { ...customer }\n  if (!editingCompany.value.templateId) editingCompany.value.templateId = DEFAULT_TEMPLATE_ID\n  showEditSidebar.value = true\n}\n\nconst updateCompany = () => {\n  if (!isValidRut(editingCompany.value.rut)) {\n    alert('RUT inválido')\n    return\n  }\n  const index = customers.value.findIndex(c => c.id === editingCompany.value.id)\n  if (index !== -1) customers.value[index] = { ...editingCompany.value }\n  showEditSidebar.value = false\n}\n\nconst deleteSelected = (ids) => {\n  customers.value = customers.value.filter(c => !ids.includes(c.id))\n}\n\nconst copyCustomerData = (customer) => {\n  const data = `Nombre: ${customer.name}\\nRUT: ${customer.rut}\\nContacto: ${customer.contact}`\n  navigator.clipboard.writeText(data).then(() => {\n    copiedId.value = customer.id\n    setTimeout(() => copiedId.value = null, 1000)\n  })\n}\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}