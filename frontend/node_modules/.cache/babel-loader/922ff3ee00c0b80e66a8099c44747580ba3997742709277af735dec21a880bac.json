{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nexport default {\n  __name: 'AppHeader',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const user = ref({});\n    const profileImage = ref('');\n\n    // Cargar datos del usuario desde localStorage al montar\n    onMounted(() => {\n      const storedUser = localStorage.getItem('user');\n      user.value = storedUser ? JSON.parse(storedUser) : {};\n      profileImage.value = user.value.profileImage || 'https://img.freepik.com/vector-premium/perfil-hombre_1083548-15963.jpg';\n    });\n    const userName = computed(() => user.value.name || 'Invitado');\n    const userRole = computed(() => user.value.role || 'Invitado');\n    const fileInput = ref(null);\n    const showDropdown = ref(false);\n    const selectFile = () => fileInput.value.click();\n    const previewImage = event => {\n      const file = event.target.files[0];\n      if (!file) return;\n      const reader = new FileReader();\n      reader.onload = () => {\n        const img = new Image();\n        img.src = reader.result;\n        img.onload = () => {\n          const canvas = document.createElement('canvas');\n          const maxSize = 300; // tamaño máximo\n          let width = img.width;\n          let height = img.height;\n          if (width > height) {\n            if (width > maxSize) {\n              height = height * (maxSize / width);\n              width = maxSize;\n            }\n          } else {\n            if (height > maxSize) {\n              width = width * (maxSize / height);\n              height = maxSize;\n            }\n          }\n          canvas.width = width;\n          canvas.height = height;\n          const ctx = canvas.getContext('2d');\n          ctx.drawImage(img, 0, 0, width, height);\n          const dataUrl = canvas.toDataURL('image/jpeg', 0.7); // calidad 70%\n          profileImage.value = dataUrl;\n\n          // Guardar en localStorage seguro\n          const updatedUser = {\n            ...user.value,\n            profileImage: dataUrl\n          };\n          user.value = updatedUser;\n          localStorage.setItem('user', JSON.stringify(updatedUser));\n        };\n      };\n      reader.readAsDataURL(file);\n    };\n    const logout = () => {\n      localStorage.removeItem('user');\n      user.value = {};\n      router.push('/');\n    };\n    const __returned__ = {\n      router,\n      user,\n      profileImage,\n      userName,\n      userRole,\n      fileInput,\n      showDropdown,\n      selectFile,\n      previewImage,\n      logout,\n      ref,\n      computed,\n      onMounted,\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","useRouter","router","user","profileImage","storedUser","localStorage","getItem","value","JSON","parse","userName","name","userRole","role","fileInput","showDropdown","selectFile","click","previewImage","event","file","target","files","reader","FileReader","onload","img","Image","src","result","canvas","document","createElement","maxSize","width","height","ctx","getContext","drawImage","dataUrl","toDataURL","updatedUser","setItem","stringify","readAsDataURL","logout","removeItem","push"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/components/AppHeader.vue"],"sourcesContent":["<template>\n  <header class=\"bg-[#1f2937] border-b border-gray-700 flex justify-between items-center px-3 py-2\">\n    <!-- Logo -->\n    <div class=\"flex items-center gap-2\">\n      <button class=\"md:hidden text-white text-2xl px-6\" @click=\"$emit('toggle-sidebar')\">☰</button>\n      <img alt=\"Logo\" src=\"https://www.gpsenchile.com/wp-content/uploads/2023/06/logowebblanco.png\" class=\"w-36 h-15\" />\n    </div>\n\n    <!-- Perfil -->\n    <div class=\"flex items-center gap-2 text-white\">\n      <!-- Imagen editable -->\n      <div class=\"relative w-10 h-10\">\n        <img :src=\"profileImage\" alt=\"Perfil\" class=\"w-full h-full rounded-full object-cover\" />\n        <button @click=\"selectFile\"\n          class=\"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 text-white rounded-full opacity-0 hover:opacity-100 transition-opacity\"\n          title=\"Editar foto\">\n          ✎\n        </button>\n        <input type=\"file\" ref=\"fileInput\" accept=\"image/*\" class=\"hidden\" @change=\"previewImage\" />\n      </div>\n\n      <!-- Texto + flecha -->\n      <div class=\"relative\">\n        <button @click=\"showDropdown = !showDropdown\"\n          class=\"flex flex-col items-start px-2 py-1 rounded hover:bg-[#2a3748] transition-colors\">\n          <div class=\"flex items-center gap-1\">\n            <strong>{{ userName }}</strong>\n            <span class=\"transition-transform duration-200 text-[10px]\" :class=\"{ 'rotate-180': showDropdown }\">▼</span>\n          </div>\n          <span>{{ userRole }}</span>\n        </button>\n\n        <!-- Dropdown -->\n        <div v-if=\"showDropdown\" class=\"absolute right-0 mt-1 w-40 bg-[#1f2937] text-white rounded-lg shadow-lg z-50\">\n          <ul class=\"list-none p-2\">\n            <li>\n              <hr class=\"border-t my-1 border-gray-600\" />\n            </li>\n            <li>\n              <a @click.prevent=\"logout\"\n                class=\"w-full group relative inline-flex items-center overflow-hidden gap-x-3.5 py-2 px-2.5 rounded-lg text-sm hover:bg-[#ff6600] cursor-pointer\">\n                <span class=\"absolute -start-full transition-all group-hover:start-2\">\n                  <svg class=\"w-4 h-4\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"\n                    stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                      d=\"M17 8l4 4m0 0l-4 4m4-4H3\" />\n                  </svg>\n                </span>\n                <span class=\"transition-all group-hover:ms-4\">Cerrar sesión</span>\n              </a>\n            </li>\n          </ul>\n        </div>\n\n      </div>\n    </div>\n  </header>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\n\nconst router = useRouter()\nconst user = ref({})\nconst profileImage = ref('')\n\n// Cargar datos del usuario desde localStorage al montar\nonMounted(() => {\n  const storedUser = localStorage.getItem('user')\n  user.value = storedUser ? JSON.parse(storedUser) : {}\n\n\n    profileImage.value = user.value.profileImage || 'https://img.freepik.com/vector-premium/perfil-hombre_1083548-15963.jpg'\n})\n\nconst userName = computed(() => user.value.name || 'Invitado')\nconst userRole = computed(() => user.value.role || 'Invitado')\n\n\nconst fileInput = ref(null)\nconst showDropdown = ref(false)\n\nconst selectFile = () => fileInput.value.click()\nconst previewImage = (event) => {\n  const file = event.target.files[0]\n  if (!file) return\n\n  const reader = new FileReader()\n  reader.onload = () => {\n    const img = new Image()\n    img.src = reader.result\n    img.onload = () => {\n      const canvas = document.createElement('canvas')\n      const maxSize = 300 // tamaño máximo\n      let width = img.width\n      let height = img.height\n\n      if(width > height){\n        if(width > maxSize){\n          height = height * (maxSize / width)\n          width = maxSize\n        }\n      } else {\n        if(height > maxSize){\n          width = width * (maxSize / height)\n          height = maxSize\n        }\n      }\n\n      canvas.width = width\n      canvas.height = height\n      const ctx = canvas.getContext('2d')\n      ctx.drawImage(img, 0, 0, width, height)\n\n      const dataUrl = canvas.toDataURL('image/jpeg', 0.7) // calidad 70%\n      profileImage.value = dataUrl\n\n      // Guardar en localStorage seguro\n      const updatedUser = { ...user.value, profileImage: dataUrl }\n      user.value = updatedUser\n      localStorage.setItem('user', JSON.stringify(updatedUser))\n    }\n  }\n  reader.readAsDataURL(file)\n}\n\n\nconst logout = () => {\n  localStorage.removeItem('user')\n  user.value = {}\n  router.push('/')\n}\n</script>\n"],"mappings":";AA4DA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,KAAI;AAC7C,SAASC,SAAS,QAAQ,YAAW;;;;;;;IAErC,MAAMC,MAAM,GAAGD,SAAS,CAAC;IACzB,MAAME,IAAI,GAAGL,GAAG,CAAC,CAAC,CAAC;IACnB,MAAMM,YAAY,GAAGN,GAAG,CAAC,EAAE;;IAE3B;IACAE,SAAS,CAAC,MAAM;MACd,MAAMK,UAAU,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM;MAC9CJ,IAAI,CAACK,KAAK,GAAGH,UAAU,GAAGI,IAAI,CAACC,KAAK,CAACL,UAAU,CAAC,GAAG,CAAC;MAGlDD,YAAY,CAACI,KAAK,GAAGL,IAAI,CAACK,KAAK,CAACJ,YAAY,IAAI,wEAAuE;IAC3H,CAAC;IAED,MAAMO,QAAQ,GAAGZ,QAAQ,CAAC,MAAMI,IAAI,CAACK,KAAK,CAACI,IAAI,IAAI,UAAU;IAC7D,MAAMC,QAAQ,GAAGd,QAAQ,CAAC,MAAMI,IAAI,CAACK,KAAK,CAACM,IAAI,IAAI,UAAU;IAG7D,MAAMC,SAAS,GAAGjB,GAAG,CAAC,IAAI;IAC1B,MAAMkB,YAAY,GAAGlB,GAAG,CAAC,KAAK;IAE9B,MAAMmB,UAAU,GAAGA,CAAA,KAAMF,SAAS,CAACP,KAAK,CAACU,KAAK,CAAC;IAC/C,MAAMC,YAAY,GAAIC,KAAK,IAAK;MAC9B,MAAMC,IAAI,GAAGD,KAAK,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC;MACjC,IAAI,CAACF,IAAI,EAAE;MAEX,MAAMG,MAAM,GAAG,IAAIC,UAAU,CAAC;MAC9BD,MAAM,CAACE,MAAM,GAAG,MAAM;QACpB,MAAMC,GAAG,GAAG,IAAIC,KAAK,CAAC;QACtBD,GAAG,CAACE,GAAG,GAAGL,MAAM,CAACM,MAAK;QACtBH,GAAG,CAACD,MAAM,GAAG,MAAM;UACjB,MAAMK,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ;UAC9C,MAAMC,OAAO,GAAG,GAAG,EAAC;UACpB,IAAIC,KAAK,GAAGR,GAAG,CAACQ,KAAI;UACpB,IAAIC,MAAM,GAAGT,GAAG,CAACS,MAAK;UAEtB,IAAGD,KAAK,GAAGC,MAAM,EAAC;YAChB,IAAGD,KAAK,GAAGD,OAAO,EAAC;cACjBE,MAAM,GAAGA,MAAM,IAAIF,OAAO,GAAGC,KAAK;cAClCA,KAAK,GAAGD,OAAM;YAChB;UACF,CAAC,MAAM;YACL,IAAGE,MAAM,GAAGF,OAAO,EAAC;cAClBC,KAAK,GAAGA,KAAK,IAAID,OAAO,GAAGE,MAAM;cACjCA,MAAM,GAAGF,OAAM;YACjB;UACF;UAEAH,MAAM,CAACI,KAAK,GAAGA,KAAI;UACnBJ,MAAM,CAACK,MAAM,GAAGA,MAAK;UACrB,MAAMC,GAAG,GAAGN,MAAM,CAACO,UAAU,CAAC,IAAI;UAClCD,GAAG,CAACE,SAAS,CAACZ,GAAG,EAAE,CAAC,EAAE,CAAC,EAAEQ,KAAK,EAAEC,MAAM;UAEtC,MAAMI,OAAO,GAAGT,MAAM,CAACU,SAAS,CAAC,YAAY,EAAE,GAAG,CAAC,EAAC;UACpDrC,YAAY,CAACI,KAAK,GAAGgC,OAAM;;UAE3B;UACA,MAAME,WAAW,GAAG;YAAE,GAAGvC,IAAI,CAACK,KAAK;YAAEJ,YAAY,EAAEoC;UAAQ;UAC3DrC,IAAI,CAACK,KAAK,GAAGkC,WAAU;UACvBpC,YAAY,CAACqC,OAAO,CAAC,MAAM,EAAElC,IAAI,CAACmC,SAAS,CAACF,WAAW,CAAC;QAC1D;MACF;MACAlB,MAAM,CAACqB,aAAa,CAACxB,IAAI;IAC3B;IAGA,MAAMyB,MAAM,GAAGA,CAAA,KAAM;MACnBxC,YAAY,CAACyC,UAAU,CAAC,MAAM;MAC9B5C,IAAI,CAACK,KAAK,GAAG,CAAC;MACdN,MAAM,CAAC8C,IAAI,CAAC,GAAG;IACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}