{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { ref, watch } from 'vue';\n\n// Props\n\nexport default {\n  __name: 'ModalAgregar',\n  props: {\n    showAddModal: Boolean,\n    selectedPatente: String,\n    mantenciones: Array,\n    templates: Array\n  },\n  emits: ['close', 'save'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n\n    // Emits\n    const emit = __emit;\n\n    // Estado local\n    const selectedTemplateId = ref('');\n    const selectedTemplate = ref(null);\n    const maintenance = ref({\n      name: '',\n      type: '',\n      km: '',\n      fechaUltima: '',\n      details: ''\n    });\n\n    //  Cuando cambia el template seleccionado\n    function onTemplateSelect() {\n      const template = props.templates.find(t => t.id === parseInt(selectedTemplateId.value));\n      if (!template) return;\n      selectedTemplate.value = template;\n      maintenance.value.name = template.name;\n      maintenance.value.type = template.type;\n\n      // Inicializar campo de umbral\n      if (template.type === 'Por Od贸metro') {\n        maintenance.value.km = 0;\n        maintenance.value.fechaUltima = '';\n      } else {\n        maintenance.value.fechaUltima = new Date().toISOString().split('T')[0];\n        maintenance.value.km = '';\n      }\n    }\n\n    //  Guardar y emitir al padre\n    function guardar() {\n      if (!selectedTemplate.value) return;\n      const nuevaMantencion = {\n        nombre: maintenance.value.name,\n        tipo: maintenance.value.type,\n        km: maintenance.value.km,\n        fechaUltima: maintenance.value.fechaUltima,\n        detalles: maintenance.value.details,\n        estado: 'OK'\n      };\n      emit('save', {\n        nuevaMantencion,\n        templateId: selectedTemplate.value.id\n      });\n    }\n    const __returned__ = {\n      props,\n      emit,\n      selectedTemplateId,\n      selectedTemplate,\n      maintenance,\n      onTemplateSelect,\n      guardar,\n      ref,\n      watch\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","watch","props","__props","emit","__emit","selectedTemplateId","selectedTemplate","maintenance","name","type","km","fechaUltima","details","onTemplateSelect","template","templates","find","t","id","parseInt","value","Date","toISOString","split","guardar","nuevaMantencion","nombre","tipo","detalles","estado","templateId"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/components/MantencionesUi/ModalAgregar.vue"],"sourcesContent":["<template>\n  <!-- Fondo semitransparente -->\n  <div v-if=\"showAddModal\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n    <div class=\"bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 rounded-lg shadow-lg w-full max-w-3xl p-6 relative\">\n      \n      <!-- T铆tulo -->\n      <h2 class=\"text-xl font-bold mb-4 text-center\">Agregar Mantenci贸n</h2>\n\n      <!-- Selector de Template -->\n      <div class=\"mb-4\">\n        <label class=\"font-semibold block mb-1\">Seleccionar tipo de mantenci贸n</label>\n        <select v-model=\"selectedTemplateId\" @change=\"onTemplateSelect\"\n          class=\"w-full border border-gray-300 dark:border-gray-700 rounded px-2 py-1 bg-white dark:bg-gray-800\">\n          <option value=\"\">Seleccione una plantilla...</option>\n          <option v-for=\"t in templates\" :key=\"t.id\" :value=\"t.id\" :disabled=\"t.used\">\n            {{ t.name }} - {{ t.type }}\n          </option>\n        </select>\n      </div>\n\n      <!-- Formulario de detalles -->\n      <div v-if=\"selectedTemplate\" class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n\n        <div>\n          <label class=\"font-semibold block mb-1\">Nombre</label>\n          <input v-model=\"maintenance.name\" disabled class=\"w-full border rounded px-2 py-1 dark:bg-gray-800\" />\n        </div>\n\n        <div>\n          <label class=\"font-semibold block mb-1\">Tipo</label>\n          <input v-model=\"maintenance.type\" disabled class=\"w-full border rounded px-2 py-1 dark:bg-gray-800\" />\n        </div>\n\n        <!-- Umbral din谩mico -->\n        <div v-if=\"maintenance.type === 'Por Od贸metro'\">\n          <label class=\"font-semibold block mb-1\">Umbral (Km)</label>\n          <input type=\"number\" v-model=\"maintenance.km\" class=\"w-full border rounded px-2 py-1 dark:bg-gray-800\" />\n        </div>\n\n        <div v-else-if=\"maintenance.type === 'Por Tiempo'\">\n          <label class=\"font-semibold block mb-1\">Umbral (Fecha)</label>\n          <input type=\"date\" v-model=\"maintenance.fechaUltima\" class=\"w-full border rounded px-2 py-1 dark:bg-gray-800\" />\n        </div>\n\n        <div class=\"md:col-span-2\">\n          <label class=\"font-semibold block mb-1\">Detalles</label>\n          <textarea v-model=\"maintenance.details\" class=\"w-full border rounded px-2 py-1 dark:bg-gray-800\" rows=\"2\"></textarea>\n        </div>\n\n      </div>\n\n      <!-- Botones -->\n      <div class=\"mt-6 flex justify-end gap-3\">\n        <button @click=\"$emit('close')\" class=\"px-4 py-2 rounded bg-gray-400 hover:bg-gray-500 text-white\">Cancelar</button>\n        <button @click=\"guardar\" :disabled=\"!selectedTemplate\"\n          class=\"px-4 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50\">Guardar</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue'\n\n// Props\nconst props = defineProps({\n  showAddModal: Boolean,\n  selectedPatente: String,\n  mantenciones: Array,\n  templates: Array\n})\n\n// Emits\nconst emit = defineEmits(['close', 'save'])\n\n// Estado local\nconst selectedTemplateId = ref('')\nconst selectedTemplate = ref(null)\nconst maintenance = ref({\n  name: '',\n  type: '',\n  km: '',\n  fechaUltima: '',\n  details: ''\n})\n\n//  Cuando cambia el template seleccionado\nfunction onTemplateSelect() {\n  const template = props.templates.find(t => t.id === parseInt(selectedTemplateId.value))\n  if (!template) return\n\n  selectedTemplate.value = template\n  maintenance.value.name = template.name\n  maintenance.value.type = template.type\n\n  // Inicializar campo de umbral\n  if (template.type === 'Por Od贸metro') {\n    maintenance.value.km = 0\n    maintenance.value.fechaUltima = ''\n  } else {\n    maintenance.value.fechaUltima = new Date().toISOString().split('T')[0]\n    maintenance.value.km = ''\n  }\n}\n\n//  Guardar y emitir al padre\nfunction guardar() {\n  if (!selectedTemplate.value) return\n\n  const nuevaMantencion = {\n    nombre: maintenance.value.name,\n    tipo: maintenance.value.type,\n    km: maintenance.value.km,\n    fechaUltima: maintenance.value.fechaUltima,\n    detalles: maintenance.value.details,\n    estado: 'OK'\n  }\n\n  emit('save', { nuevaMantencion, templateId: selectedTemplate.value.id })\n}\n</script>\n"],"mappings":";;AA8DA,SAASA,GAAG,EAAEC,KAAK,QAAQ,KAAI;;AAE/B;;;;;;;;;;;;;;;;IACA,MAAMC,KAAK,GAAGC,OAAA;;IAOd;IACA,MAAMC,IAAI,GAAGC,MAAA;;IAEb;IACA,MAAMC,kBAAkB,GAAGN,GAAG,CAAC,EAAE;IACjC,MAAMO,gBAAgB,GAAGP,GAAG,CAAC,IAAI;IACjC,MAAMQ,WAAW,GAAGR,GAAG,CAAC;MACtBS,IAAI,EAAE,EAAE;MACRC,IAAI,EAAE,EAAE;MACRC,EAAE,EAAE,EAAE;MACNC,WAAW,EAAE,EAAE;MACfC,OAAO,EAAE;IACX,CAAC;;IAED;IACA,SAASC,gBAAgBA,CAAA,EAAG;MAC1B,MAAMC,QAAQ,GAAGb,KAAK,CAACc,SAAS,CAACC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,KAAKC,QAAQ,CAACd,kBAAkB,CAACe,KAAK,CAAC;MACtF,IAAI,CAACN,QAAQ,EAAE;MAEfR,gBAAgB,CAACc,KAAK,GAAGN,QAAO;MAChCP,WAAW,CAACa,KAAK,CAACZ,IAAI,GAAGM,QAAQ,CAACN,IAAG;MACrCD,WAAW,CAACa,KAAK,CAACX,IAAI,GAAGK,QAAQ,CAACL,IAAG;;MAErC;MACA,IAAIK,QAAQ,CAACL,IAAI,KAAK,cAAc,EAAE;QACpCF,WAAW,CAACa,KAAK,CAACV,EAAE,GAAG;QACvBH,WAAW,CAACa,KAAK,CAACT,WAAW,GAAG,EAAC;MACnC,CAAC,MAAM;QACLJ,WAAW,CAACa,KAAK,CAACT,WAAW,GAAG,IAAIU,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;QACrEhB,WAAW,CAACa,KAAK,CAACV,EAAE,GAAG,EAAC;MAC1B;IACF;;IAEA;IACA,SAASc,OAAOA,CAAA,EAAG;MACjB,IAAI,CAAClB,gBAAgB,CAACc,KAAK,EAAE;MAE7B,MAAMK,eAAe,GAAG;QACtBC,MAAM,EAAEnB,WAAW,CAACa,KAAK,CAACZ,IAAI;QAC9BmB,IAAI,EAAEpB,WAAW,CAACa,KAAK,CAACX,IAAI;QAC5BC,EAAE,EAAEH,WAAW,CAACa,KAAK,CAACV,EAAE;QACxBC,WAAW,EAAEJ,WAAW,CAACa,KAAK,CAACT,WAAW;QAC1CiB,QAAQ,EAAErB,WAAW,CAACa,KAAK,CAACR,OAAO;QACnCiB,MAAM,EAAE;MACV;MAEA1B,IAAI,CAAC,MAAM,EAAE;QAAEsB,eAAe;QAAEK,UAAU,EAAExB,gBAAgB,CAACc,KAAK,CAACF;MAAG,CAAC;IACzE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}