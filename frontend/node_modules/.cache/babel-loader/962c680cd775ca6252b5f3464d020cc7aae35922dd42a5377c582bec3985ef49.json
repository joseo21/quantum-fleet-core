{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { ref, computed } from 'vue';\nimport SvgIcon from '@/components/icons/SvgIcon.vue';\nexport default {\n  __name: 'EmpresasView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const showAddModal = ref(false);\n    const step = ref(1);\n    const selectedTemplate = ref(null);\n    const newCompany = ref({\n      name: '',\n      rut: '',\n      contact: '',\n      city: ''\n    });\n\n    // Plantillas\n    const templates = ref([{\n      id: 1,\n      name: 'Básico',\n      description: 'Acceso limitado a reportes y panel general.'\n    }, {\n      id: 2,\n      name: 'Profesional',\n      description: 'Incluye reportes y comentarios.'\n    }, {\n      id: 3,\n      name: 'Avanzado',\n      description: 'Incluye dashboards personalizados y reportes completos.'\n    }, {\n      id: 4,\n      name: 'Full',\n      description: 'Todas las funciones habilitadas.'\n    }]);\n\n    // Validación RUT chileno (formato xx.xxx.xxx-x)\n    const isValidRut = rut => /^(\\d{1,2}\\.\\d{3}\\.\\d{3}-[\\dkK])$/.test(rut);\n\n    // Formatear RUT\n    const formatRut = company => {\n      let rut = company.rut.replace(/[^0-9kK]/g, '');\n      if (rut.length > 9) rut = rut.slice(0, 9);\n      if (rut.length > 1) {\n        const body = rut.slice(0, -1);\n        const dv = rut.slice(-1);\n        const reversed = body.split('').reverse();\n        const withDots = [];\n        reversed.forEach((char, i) => {\n          if (i > 0 && i % 3 === 0) withDots.push('.');\n          withDots.push(char);\n        });\n        company.rut = withDots.reverse().join('') + '-' + dv;\n      } else {\n        company.rut = rut;\n      }\n    };\n\n    // Validación paso 1\n    const isStep1Valid = computed(() => {\n      const {\n        name,\n        rut,\n        contact,\n        city\n      } = newCompany.value;\n      return name && rut && contact && city && isValidRut(rut);\n    });\n\n    // Texto dinámico del botón\n    const modalButtonText = computed(() => step.value === 1 ? 'Siguiente' : 'Crear Empresa');\n\n    // Cancelar modal\n    const cancel = () => {\n      showAddModal.value = false;\n      step.value = 1;\n      selectedTemplate.value = null;\n      newCompany.value = {\n        name: '',\n        rut: '',\n        contact: '',\n        city: ''\n      };\n    };\n\n    // Ir al siguiente paso\n    const goToNextStep = () => {\n      if (isStep1Valid.value) step.value = 2;\n    };\n\n    // Agregar empresa (puedes enlazar con tu array de empresas)\n    const isModalButtonDisabled = computed(() => step.value === 2 && !selectedTemplate.value);\n    const addCompany = () => {\n      if (!selectedTemplate.value) return;\n      alert('Empresa creada correctamente!');\n      cancel();\n    };\n    const __returned__ = {\n      showAddModal,\n      step,\n      selectedTemplate,\n      newCompany,\n      templates,\n      isValidRut,\n      formatRut,\n      isStep1Valid,\n      modalButtonText,\n      cancel,\n      goToNextStep,\n      isModalButtonDisabled,\n      addCompany,\n      ref,\n      computed,\n      SvgIcon\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","SvgIcon","showAddModal","step","selectedTemplate","newCompany","name","rut","contact","city","templates","id","description","isValidRut","test","formatRut","company","replace","length","slice","body","dv","reversed","split","reverse","withDots","forEach","char","i","push","join","isStep1Valid","value","modalButtonText","cancel","goToNextStep","isModalButtonDisabled","addCompany","alert"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/Views/EmpresasView.vue"],"sourcesContent":["<template>\n  <!-- Modal multi-paso -->\n  <div v-if=\"showAddModal\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n    <div class=\"bg-gray-800 text-white rounded-lg relative flex flex-col w-full max-w-lg h-auto p-6\">\n\n      <!-- Botón volver paso 2 -> 1 -->\n      <button v-if=\"step === 2\" @click=\"step = 1\" class=\"absolute top-4 left-4 p-2 rounded hover:bg-gray-700 transition\"\n        title=\"Volver\">\n        <SvgIcon name=\"arrow-left\" class=\"w-6 h-6\" />\n      </button>\n\n      <h2 class=\"text-2xl font-bold mb-4 text-center\">\n        {{ step === 1 ? 'Agregar Empresa' : 'Seleccionar Template' }}\n      </h2>\n\n      <span class=\"h-px bg-gray-600 mb-4\"></span>\n\n      <!-- Paso 1 -->\n      <form v-if=\"step === 1\" @submit.prevent=\"goToNextStep\" class=\"flex-1 flex flex-col gap-3 py-2 overflow-y-auto\">\n        <input v-model=\"newCompany.name\" type=\"text\" placeholder=\"Nombre de la empresa\"\n          class=\"px-3 py-2 rounded bg-gray-700 text-white focus:outline-none w-full\" required />\n\n        <input v-model=\"newCompany.rut\" type=\"text\" placeholder=\"RUT de la empresa\"\n          class=\"px-3 py-2 rounded bg-gray-700 text-white focus:outline-none w-full\" required\n          @input=\"formatRut(newCompany)\" />\n\n        <input v-model=\"newCompany.contact\" type=\"text\" placeholder=\"Contacto\"\n          class=\"px-3 py-2 rounded bg-gray-700 text-white focus:outline-none w-full\" required />\n\n        <input v-model=\"newCompany.city\" type=\"text\" placeholder=\"Ciudad de la empresa\"\n          class=\"px-3 py-2 rounded bg-gray-700 text-white focus:outline-none w-full\" required />\n      </form>\n\n      <!-- Paso 2 -->\n      <div v-else class=\"grid grid-cols-1 sm:grid-cols-2 gap-4 py-4\">\n        <div v-for=\"template in templates\" :key=\"template.id\" @click=\"selectedTemplate = template.id\" :class=\"[\n          'p-6 rounded-lg border cursor-pointer text-center transition',\n          selectedTemplate === template.id\n            ? 'border-blue-500 bg-blue-700'\n            : 'border-gray-600 hover:bg-gray-700'\n        ]\">\n          <h3 class=\"text-lg font-semibold mb-2\">{{ template.name }}</h3>\n          <p class=\"text-gray-300 text-sm\">{{ template.description }}</p>\n        </div>\n      </div>\n\n      <!-- Botones del modal multi-paso -->\n      <div class=\"flex justify-between mt-6\">\n        <button @click=\"cancel\" class=\"bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded w-[48%]\">\n          Cancelar\n        </button>\n\n        <button v-if=\"step === 1\" @click=\"goToNextStep\" :disabled=\"!isStep1Valid\" \n          :class=\"['px-4 py-2 rounded w-[48%]', isStep1Valid ? 'bg-blue-600 hover:bg-blue-700' : 'bg-blue-600 opacity-50 cursor-not-allowed']\">\n          {{ modalButtonText }}\n        </button>\n\n        <button v-else @click=\"addCompany\" :disabled=\"isModalButtonDisabled\" :class=\"[\n          'px-4 py-2 rounded w-[48%]',\n          isModalButtonDisabled\n            ? 'bg-green-600 opacity-50 cursor-not-allowed'\n            : 'bg-green-600 hover:bg-green-700'\n        ]\">\n          {{ modalButtonText }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue'\nimport SvgIcon from '@/components/icons/SvgIcon.vue'\n\nconst showAddModal = ref(false)\nconst step = ref(1)\nconst selectedTemplate = ref(null)\nconst newCompany = ref({ name: '', rut: '', contact: '', city: '' })\n\n// Plantillas\nconst templates = ref([\n  { id: 1, name: 'Básico', description: 'Acceso limitado a reportes y panel general.' },\n  { id: 2, name: 'Profesional', description: 'Incluye reportes y comentarios.' },\n  { id: 3, name: 'Avanzado', description: 'Incluye dashboards personalizados y reportes completos.' },\n  { id: 4, name: 'Full', description: 'Todas las funciones habilitadas.' }\n])\n\n// Validación RUT chileno (formato xx.xxx.xxx-x)\nconst isValidRut = (rut) => /^(\\d{1,2}\\.\\d{3}\\.\\d{3}-[\\dkK])$/.test(rut)\n\n// Formatear RUT\nconst formatRut = (company) => {\n  let rut = company.rut.replace(/[^0-9kK]/g, '')\n  if (rut.length > 9) rut = rut.slice(0, 9)\n\n  if (rut.length > 1) {\n    const body = rut.slice(0, -1)\n    const dv = rut.slice(-1)\n    const reversed = body.split('').reverse()\n    const withDots = []\n    reversed.forEach((char, i) => { if (i > 0 && i % 3 === 0) withDots.push('.'); withDots.push(char) })\n    company.rut = withDots.reverse().join('') + '-' + dv\n  } else {\n    company.rut = rut\n  }\n}\n\n// Validación paso 1\nconst isStep1Valid = computed(() => {\n  const { name, rut, contact, city } = newCompany.value\n  return name && rut && contact && city && isValidRut(rut)\n})\n\n// Texto dinámico del botón\nconst modalButtonText = computed(() => step.value === 1 ? 'Siguiente' : 'Crear Empresa')\n\n// Cancelar modal\nconst cancel = () => {\n  showAddModal.value = false\n  step.value = 1\n  selectedTemplate.value = null\n  newCompany.value = { name: '', rut: '', contact: '', city: '' }\n}\n\n// Ir al siguiente paso\nconst goToNextStep = () => {\n  if (isStep1Valid.value) step.value = 2\n}\n\n// Agregar empresa (puedes enlazar con tu array de empresas)\nconst isModalButtonDisabled = computed(() => step.value === 2 && !selectedTemplate.value)\nconst addCompany = () => {\n  if (!selectedTemplate.value) return\n  alert('Empresa creada correctamente!')\n  cancel()\n}\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}