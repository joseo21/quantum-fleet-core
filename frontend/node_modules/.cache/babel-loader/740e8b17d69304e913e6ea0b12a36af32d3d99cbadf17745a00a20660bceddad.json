{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nexport default {\n  name: 'ModalVerMantenciones',\n  props: {\n    showViewModal: {\n      type: Boolean,\n      required: true\n    },\n    selectedPatente: {\n      type: String,\n      required: true\n    },\n    mantenciones: {\n      type: Array,\n      required: true\n    },\n    // Todas las mantenciones de todos los vehículos\n    vehiculos: {\n      type: Array,\n      required: true\n    } // Para obtener el odómetro actual\n  },\n  computed: {\n    mantencionesPorVehiculo() {\n      const vehiculo = this.vehiculos.find(v => v.patente === this.selectedPatente);\n      const actualKm = vehiculo ? vehiculo.odometro : 0;\n      return this.mantenciones.filter(m => m.patente === this.selectedPatente).map(m => {\n        let ultimo = m.type === 'Por Odómetro' ? Number(m.km) : new Date(m.fechaUltima);\n        let umbral = m.type === 'Por Odómetro' ? ultimo + Number(m.intervalo.replace(' km', '')) : new Date(ultimo.getTime() + Number(m.intervalo.replace(' días', '')) * 24 * 60 * 60 * 1000);\n        let actual = m.type === 'Por Odómetro' ? actualKm : new Date();\n        let faltante = m.type === 'Por Odómetro' ? umbral - actual : Math.ceil((umbral - actual) / (1000 * 60 * 60 * 24));\n        let estado = '';\n        if (m.type === 'Por Odómetro') {\n          if (faltante <= 0) estado = 'Urgente';else if (faltante <= Number(m.intervalo.replace(' km', '')) * 0.2) estado = 'Próxima';else estado = 'OK';\n        } else {\n          if (faltante <= 0) estado = 'Urgente';else if (faltante <= Number(m.intervalo.replace(' días', '')) * 0.2) estado = 'Próxima';else estado = 'OK';\n        }\n        return {\n          ...m,\n          ultimo: m.type === 'Por Odómetro' ? ultimo : ultimo.toLocaleDateString(),\n          umbral: m.type === 'Por Odómetro' ? umbral : umbral.toLocaleDateString(),\n          actual: m.type === 'Por Odómetro' ? actual : actual.toLocaleDateString(),\n          faltante,\n          estado,\n          fechaCreacion: new Date(m.fechaCreacion).toLocaleString()\n        };\n      });\n    }\n  },\n  methods: {\n    estadoClase(m) {\n      switch (m.estado) {\n        case 'Urgente':\n          return 'text-red-600 font-bold';\n        case 'Próxima':\n          return 'text-orange-500 font-semibold';\n        default:\n          return 'text-green-600 font-medium';\n      }\n    }\n  }\n};","map":{"version":3,"names":["name","props","showViewModal","type","Boolean","required","selectedPatente","String","mantenciones","Array","vehiculos","computed","mantencionesPorVehiculo","vehiculo","find","v","patente","actualKm","odometro","filter","m","map","ultimo","Number","km","Date","fechaUltima","umbral","intervalo","replace","getTime","actual","faltante","Math","ceil","estado","toLocaleDateString","fechaCreacion","toLocaleString","methods","estadoClase"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/components/MantencionesUi/ModalVerMantenciones.vue"],"sourcesContent":["<template>\n  <div v-if=\"showViewModal\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n    <div class=\"bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 rounded-lg w-full max-w-5xl h-auto p-6 border border-gray-300 dark:border-gray-700 shadow-xl overflow-auto\">\n      <!-- Título -->\n      <h2 class=\"text-2xl font-bold mb-4 text-center text-[#102372] dark:text-[#ff6600]\">\n        Mantenciones Vehículo ({{ selectedPatente }})\n      </h2>\n      \n      <span class=\"h-px bg-gray-300 dark:bg-gray-700 mb-4\"></span>\n\n      <!-- Tabla -->\n      <table class=\"w-full table-auto border-collapse\">\n        <thead>\n          <tr class=\"bg-gray-200 dark:bg-gray-800 text-left\">\n            <th class=\"p-2 border-b\">Nombre</th>\n            <th class=\"p-2 border-b\">Tipo</th>\n            <th class=\"p-2 border-b\">Intervalo</th>\n            <th class=\"p-2 border-b\">Último</th>\n            <th class=\"p-2 border-b\">Umbral</th>\n            <th class=\"p-2 border-b\">Actual</th>\n            <th class=\"p-2 border-b\">Faltante</th>\n            <th class=\"p-2 border-b\">Creación</th>\n            <th class=\"p-2 border-b\">Estado</th>\n            <th class=\"p-2 border-b\">Editar</th>\n            <th class=\"p-2 border-b\">Eliminar</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"(m, index) in mantencionesPorVehiculo\" :key=\"index\" class=\"border-b\">\n            <td class=\"p-2\">{{ m.name }}</td>\n            <td class=\"p-2\">{{ m.type }}</td>\n            <td class=\"p-2\">{{ m.intervalo }}</td>\n            <td class=\"p-2\">{{ m.ultimo }}</td>\n            <td class=\"p-2\">{{ m.umbral }}</td>\n            <td class=\"p-2\">{{ m.actual }}</td>\n            <td class=\"p-2\">{{ m.faltante }}</td>\n            <td class=\"p-2\">{{ m.fechaCreacion }}</td>\n            <td class=\"p-2\">\n              <span :class=\"estadoClase(m)\">\n                {{ m.estado }}\n              </span>\n            </td>\n            <td class=\"p-2\">\n              <button @click=\"$emit('editar', m, index)\" class=\"text-blue-600 hover:underline\">Editar</button>\n            </td>\n            <td class=\"p-2\">\n              <button @click=\"$emit('eliminar', index)\" class=\"text-red-600 hover:underline\">Eliminar</button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n\n      <!-- Botón cerrar -->\n      <div class=\"flex justify-end mt-4\">\n        <button @click=\"$emit('close')\"\n          class=\"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white\">\n          Cerrar\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ModalVerMantenciones',\n  props: {\n    showViewModal: { type: Boolean, required: true },\n    selectedPatente: { type: String, required: true },\n    mantenciones: { type: Array, required: true }, // Todas las mantenciones de todos los vehículos\n    vehiculos: { type: Array, required: true } // Para obtener el odómetro actual\n  },\n  computed: {\n    mantencionesPorVehiculo() {\n      const vehiculo = this.vehiculos.find(v => v.patente === this.selectedPatente)\n      const actualKm = vehiculo ? vehiculo.odometro : 0\n\n      return this.mantenciones\n        .filter(m => m.patente === this.selectedPatente)\n        .map(m => {\n          let ultimo = m.type === 'Por Odómetro' ? Number(m.km) : new Date(m.fechaUltima)\n          let umbral = m.type === 'Por Odómetro'\n            ? ultimo + Number(m.intervalo.replace(' km', ''))\n            : new Date(ultimo.getTime() + Number(m.intervalo.replace(' días', '')) * 24*60*60*1000)\n          \n          let actual = m.type === 'Por Odómetro' ? actualKm : new Date()\n          let faltante = m.type === 'Por Odómetro' ? umbral - actual : Math.ceil((umbral - actual) / (1000*60*60*24))\n          \n          let estado = ''\n          if(m.type === 'Por Odómetro') {\n            if(faltante <= 0) estado = 'Urgente'\n            else if(faltante <= Number(m.intervalo.replace(' km',''))*0.2) estado = 'Próxima'\n            else estado = 'OK'\n          } else {\n            if(faltante <= 0) estado = 'Urgente'\n            else if(faltante <= Number(m.intervalo.replace(' días',''))*0.2) estado = 'Próxima'\n            else estado = 'OK'\n          }\n\n          return {\n            ...m,\n            ultimo: m.type === 'Por Odómetro' ? ultimo : ultimo.toLocaleDateString(),\n            umbral: m.type === 'Por Odómetro' ? umbral : umbral.toLocaleDateString(),\n            actual: m.type === 'Por Odómetro' ? actual : actual.toLocaleDateString(),\n            faltante,\n            estado,\n            fechaCreacion: new Date(m.fechaCreacion).toLocaleString()\n          }\n        })\n    }\n  },\n  methods: {\n    estadoClase(m) {\n      switch(m.estado) {\n        case 'Urgente': return 'text-red-600 font-bold'\n        case 'Próxima': return 'text-orange-500 font-semibold'\n        default: return 'text-green-600 font-medium'\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\ntable {\n  border-spacing: 0;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}