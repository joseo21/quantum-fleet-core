{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"p-2 sm:p-4 w-full flex flex-col\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" Tabla \"), _createVNode($setup[\"EmpresasTable\"], {\n    customers: $setup.customers,\n    \"search-term\": $setup.searchTerm,\n    \"rows-per-page\": $setup.rowsPerPage,\n    \"rows-per-page-options\": $setup.rowsPerPageOptions,\n    \"current-page\": $setup.currentPage,\n    \"copied-id\": $setup.copiedId,\n    \"onUpdate:searchTerm\": _cache[0] || (_cache[0] = $event => $setup.searchTerm = $event),\n    \"onUpdate:rowsPerPage\": _cache[1] || (_cache[1] = $event => $setup.rowsPerPage = Number($event)),\n    \"onUpdate:currentPage\": _cache[2] || (_cache[2] = $event => $setup.currentPage = $event),\n    onEditCustomer: $setup.editCustomer,\n    onCopyCustomer: $setup.copyCustomerData,\n    onDeleteSelected: $setup.deleteSelected\n  }, null, 8 /* PROPS */, [\"customers\", \"search-term\", \"rows-per-page\", \"current-page\", \"copied-id\"]), _createCommentVNode(\" Modal Agregar \"), $setup.showAddModal ? (_openBlock(), _createBlock($setup[\"AgregarEmpresasModal\"], {\n    key: 0,\n    show: $setup.showAddModal,\n    step: $setup.step,\n    \"new-company\": $setup.newCompany,\n    templates: $setup.templates,\n    \"selected-template\": $setup.selectedTemplate,\n    \"is-step1-valid\": $setup.isStep1Valid,\n    \"onUpdate:newCompany\": _cache[3] || (_cache[3] = $event => $setup.newCompany = $event),\n    \"onUpdate:selectedTemplate\": _cache[4] || (_cache[4] = $event => $setup.selectedTemplate = $event),\n    \"onUpdate:step\": _cache[5] || (_cache[5] = $event => $setup.step = $event),\n    onGoToNextStep: $setup.goToNextStep,\n    onAddCompany: $setup.addCompany,\n    onCancel: $setup.cancel\n  }, null, 8 /* PROPS */, [\"show\", \"step\", \"new-company\", \"templates\", \"selected-template\", \"is-step1-valid\"])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Sidebar Editar \"), $setup.showEditSidebar ? (_openBlock(), _createBlock($setup[\"EditarEmpresasSideBar\"], {\n    key: 1,\n    \"editing-company\": $setup.editingCompany,\n    templates: $setup.templates,\n    onUpdateCompany: $setup.updateCompany,\n    onCloseSidebar: _cache[6] || (_cache[6] = $event => $setup.showEditSidebar = false)\n  }, null, 8 /* PROPS */, [\"editing-company\", \"templates\"])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createCommentVNode","_createVNode","$setup","customers","searchTerm","rowsPerPage","rowsPerPageOptions","currentPage","copiedId","_cache","$event","Number","onEditCustomer","editCustomer","onCopyCustomer","copyCustomerData","onDeleteSelected","deleteSelected","showAddModal","_createBlock","show","step","newCompany","templates","selectedTemplate","isStep1Valid","onGoToNextStep","goToNextStep","onAddCompany","addCompany","onCancel","cancel","showEditSidebar","editingCompany","onUpdateCompany","updateCompany","onCloseSidebar"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/Views/EmpresasView.vue"],"sourcesContent":["<template>\n  <div class=\"p-2 sm:p-4 w-full flex flex-col\">\n    <!-- Tabla -->\n    <EmpresasTable\n      :customers=\"customers\"\n      :search-term=\"searchTerm\"\n      :rows-per-page=\"rowsPerPage\"\n      :rows-per-page-options=\"rowsPerPageOptions\"\n      :current-page=\"currentPage\"\n      :copied-id=\"copiedId\"\n      @update:searchTerm=\"searchTerm = $event\"\n      @update:rowsPerPage=\"rowsPerPage = Number($event)\"\n      @update:currentPage=\"currentPage = $event\"\n      @edit-customer=\"editCustomer\"\n      @copy-customer=\"copyCustomerData\"\n      @delete-selected=\"deleteSelected\"\n    />\n\n    <!-- Modal Agregar -->\n    <AgregarEmpresasModal\n      v-if=\"showAddModal\"\n      :show=\"showAddModal\"\n      :step=\"step\"\n      :new-company=\"newCompany\"\n      :templates=\"templates\"\n      :selected-template=\"selectedTemplate\"\n      :is-step1-valid=\"isStep1Valid\"\n      @update:newCompany=\"newCompany = $event\"\n      @update:selectedTemplate=\"selectedTemplate = $event\"\n      @update:step=\"step = $event\"\n      @go-to-next-step=\"goToNextStep\"\n      @add-company=\"addCompany\"\n      @cancel=\"cancel\"\n    />\n\n    <!-- Sidebar Editar -->\n    <EditarEmpresasSideBar\n      v-if=\"showEditSidebar\"\n      :editing-company=\"editingCompany\"\n      :templates=\"templates\"\n      @update-company=\"updateCompany\"\n      @close-sidebar=\"showEditSidebar = false\"\n    />\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue'\nimport EmpresasTable from '@/components/EmpresasUi/EmpresasTable.vue'\nimport AgregarEmpresasModal from '@/components/EmpresasUi/AgregarEmpresasModal.vue'\nimport EditarEmpresasSideBar from '@/components/EmpresasUi/EditarEmpresasSideBar.vue'\n\nconst DEFAULT_TEMPLATE_ID = 1\n\nconst customers = ref([\n  { id: 1, createdAt: '2025-07-30', name: 'Demo Combustible', rut: '76.145.230-9', contact: 'Marcelo Díaz', city: 'Santiago' },\n  { id: 2, createdAt: '2025-07-23', name: 'Industrial Glover S.P.A.', rut: '77.239.684-2', contact: 'Patricia González', city: 'Lautaro' },\n  // ... resto de empresas\n])\n\nconst searchTerm = ref('')\nconst rowsPerPageOptions = [5, 10, 20, 50]\nconst rowsPerPage = ref(5)\nconst currentPage = ref(1)\nconst copiedId = ref(null)\n\nconst showAddModal = ref(false)\nconst step = ref(1)\nconst selectedTemplate = ref(null)\nconst newCompany = ref({ name: '', rut: '', contact: '', city: '' })\n\nconst showEditSidebar = ref(false)\nconst editingCompany = ref({ id: null, name: '', rut: '', contact: '', city: '', templateId: DEFAULT_TEMPLATE_ID })\n\nconst templates = ref([\n  { id: 1, name: 'Básico', description: 'Acceso limitado a reportes y panel general.' },\n  { id: 2, name: 'Profesional', description: 'Incluye reportes y comentarios.' },\n  { id: 3, name: 'Avanzado', description: 'Incluye dashboards personalizados y reportes completos.' },\n  { id: 4, name: 'Full', description: 'Todas las funciones habilitadas.' }\n])\n\n// Validación RUT\nconst isValidRut = (rut) => /^(\\d{1,2}\\.\\d{3}\\.\\d{3}-[\\dkK])$/.test(rut)\nconst isStep1Valid = computed(() => {\n  const { name, rut, contact, city } = newCompany.value\n  return name.trim() && rut.trim() && contact.trim() && city.trim() && isValidRut(rut)\n})\n\n// Funciones\nconst goToNextStep = () => { if (isStep1Valid.value) step.value = 2 }\n\nconst cancel = () => {\n  showAddModal.value = false\n  step.value = 1\n  selectedTemplate.value = null\n  newCompany.value = { name: '', rut: '', contact: '', city: '' }\n}\n\nconst addCompany = () => {\n  if (!selectedTemplate.value) return\n  if (!isValidRut(newCompany.value.rut)) {\n    alert('RUT inválido')\n    return\n  }\n  const id = Date.now()\n  const createdAt = new Date().toISOString().slice(0, 10)\n  customers.value.push({ id, createdAt, ...newCompany.value, templateId: selectedTemplate.value })\n  cancel()\n}\n\nconst editCustomer = (customer) => {\n  editingCompany.value = { ...customer }\n  if (!editingCompany.value.templateId) editingCompany.value.templateId = DEFAULT_TEMPLATE_ID\n  showEditSidebar.value = true\n}\n\nconst updateCompany = () => {\n  if (!isValidRut(editingCompany.value.rut)) {\n    alert('RUT inválido')\n    return\n  }\n  const index = customers.value.findIndex(c => c.id === editingCompany.value.id)\n  if (index !== -1) customers.value[index] = { ...editingCompany.value }\n  showEditSidebar.value = false\n}\n\nconst deleteSelected = (ids) => {\n  customers.value = customers.value.filter(c => !ids.includes(c.id))\n}\n\nconst copyCustomerData = (customer) => {\n  const data = `Nombre: ${customer.name}\\nRUT: ${customer.rut}\\nContacto: ${customer.contact}`\n  navigator.clipboard.writeText(data).then(() => {\n    copiedId.value = customer.id\n    setTimeout(() => copiedId.value = null, 1000)\n  })\n}\n</script>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAiC;;uBAA5CC,mBAAA,CA0CM,OA1CNC,UA0CM,GAzCJC,mBAAA,WAAc,EACdC,YAAA,CAaEC,MAAA;IAZCC,SAAS,EAAED,MAAA,CAAAC,SAAS;IACpB,aAAW,EAAED,MAAA,CAAAE,UAAU;IACvB,eAAa,EAAEF,MAAA,CAAAG,WAAW;IAC1B,uBAAqB,EAAEH,MAAA,CAAAI,kBAAkB;IACzC,cAAY,EAAEJ,MAAA,CAAAK,WAAW;IACzB,WAAS,EAAEL,MAAA,CAAAM,QAAQ;IACnB,qBAAiB,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAER,MAAA,CAAAE,UAAU,GAAGM,MAAM;IACtC,sBAAkB,EAAAD,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAER,MAAA,CAAAG,WAAW,GAAGM,MAAM,CAACD,MAAM;IAC/C,sBAAkB,EAAAD,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAER,MAAA,CAAAK,WAAW,GAAGG,MAAM;IACxCE,cAAa,EAAEV,MAAA,CAAAW,YAAY;IAC3BC,cAAa,EAAEZ,MAAA,CAAAa,gBAAgB;IAC/BC,gBAAe,EAAEd,MAAA,CAAAe;uGAGpBjB,mBAAA,mBAAsB,EAEdE,MAAA,CAAAgB,YAAY,I,cADpBC,YAAA,CAcEjB,MAAA;;IAZCkB,IAAI,EAAElB,MAAA,CAAAgB,YAAY;IAClBG,IAAI,EAAEnB,MAAA,CAAAmB,IAAI;IACV,aAAW,EAAEnB,MAAA,CAAAoB,UAAU;IACvBC,SAAS,EAAErB,MAAA,CAAAqB,SAAS;IACpB,mBAAiB,EAAErB,MAAA,CAAAsB,gBAAgB;IACnC,gBAAc,EAAEtB,MAAA,CAAAuB,YAAY;IAC5B,qBAAiB,EAAAhB,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAER,MAAA,CAAAoB,UAAU,GAAGZ,MAAM;IACtC,2BAAuB,EAAAD,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAER,MAAA,CAAAsB,gBAAgB,GAAGd,MAAM;IAClD,eAAW,EAAAD,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAER,MAAA,CAAAmB,IAAI,GAAGX,MAAM;IAC1BgB,cAAe,EAAExB,MAAA,CAAAyB,YAAY;IAC7BC,YAAW,EAAE1B,MAAA,CAAA2B,UAAU;IACvBC,QAAM,EAAE5B,MAAA,CAAA6B;qJAGX/B,mBAAA,oBAAuB,EAEfE,MAAA,CAAA8B,eAAe,I,cADvBb,YAAA,CAMEjB,MAAA;;IAJC,iBAAe,EAAEA,MAAA,CAAA+B,cAAc;IAC/BV,SAAS,EAAErB,MAAA,CAAAqB,SAAS;IACpBW,eAAc,EAAEhC,MAAA,CAAAiC,aAAa;IAC7BC,cAAa,EAAA3B,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAER,MAAA,CAAA8B,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}