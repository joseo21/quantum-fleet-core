{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { ref, watch } from 'vue';\nimport SvgIcon from '@/components/icons/SvgIcon.vue';\nexport default {\n  __name: 'EditarEmpresasSidebar',\n  props: {\n    showEditSidebar: {\n      type: Boolean,\n      required: true\n    },\n    editingCompany: {\n      type: Object,\n      required: true\n    },\n    templates: {\n      type: Array,\n      required: true\n    }\n  },\n  emits: ['close', 'update-company'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const emit = __emit;\n\n    // Usamos una copia local para evitar modificar la prop directamente antes de guardar\n    const localCompany = ref({\n      ...props.editingCompany\n    });\n\n    // Sincronizar localCompany cuando la prop editingCompany cambia\n    watch(() => props.editingCompany, newVal => {\n      localCompany.value = {\n        ...newVal\n      };\n    }, {\n      deep: true\n    });\n\n    // Lógica de validación de RUT (necesaria para guardar)\n    const isValidRut = rut => /^(\\d{1,2}\\.\\d{3}\\.\\d{3}-[\\dkK])$/.test(rut);\n\n    // Formateo automático RUT mientras se escribe\n    const formatRut = () => {\n      let rut = localCompany.value.rut.replace(/[^0-9kK]/g, '');\n      if (rut.length > 9) rut = rut.slice(0, 9);\n      if (rut.length > 1) {\n        const body = rut.slice(0, -1);\n        const dv = rut.slice(-1);\n        const reversed = body.split('').reverse();\n        const withDots = [];\n        reversed.forEach((char, i) => {\n          if (i > 0 && i % 3 === 0) withDots.push('.');\n          withDots.push(char);\n        });\n        localCompany.value.rut = withDots.reverse().join('') + '-' + dv;\n      } else {\n        localCompany.value.rut = rut;\n      }\n    };\n\n    // Guardar cambios\n    const submitUpdateCompany = () => {\n      if (!isValidRut(localCompany.value.rut)) {\n        alert('RUT inválido. Formato esperado: xx.xxx.xxx-x');\n        return;\n      }\n\n      // Enviamos la copia modificada al padre para su actualización\n      emit('update-company', localCompany.value);\n    };\n    const __returned__ = {\n      props,\n      emit,\n      localCompany,\n      isValidRut,\n      formatRut,\n      submitUpdateCompany,\n      ref,\n      watch,\n      SvgIcon\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","watch","SvgIcon","props","__props","emit","__emit","localCompany","editingCompany","newVal","value","deep","isValidRut","rut","test","formatRut","replace","length","slice","body","dv","reversed","split","reverse","withDots","forEach","char","i","push","join","submitUpdateCompany","alert"],"sources":["/home/sebastian/quantum-fleet-core/frontend/src/components/EmpresasUi/EditarEmpresasSidebar.vue"],"sourcesContent":["<template>\n  <transition name=\"slide-right\">\n    <div v-if=\"showEditSidebar\" class=\"fixed inset-0 z-50 flex justify-end\">\n      <div @click=\"$emit('close')\" class=\"absolute inset-0 bg-black bg-opacity-50\"></div>\n\n      <div\n        class=\"relative w-full max-w-md sm:w-96 bg-white dark:bg-gray-900 text-gray-900 dark:text-white shadow-xl flex flex-col h-full\">\n        <div class=\"flex-1 overflow-y-auto p-6\">\n          <button @click=\"$emit('close')\"\n            class=\"self-end p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition mb-2\">\n            <SvgIcon name=\"close\" class=\"w-6 h-6\" />\n          </button>\n          <h2 class=\"text-2xl font-bold mb-4 text-[#102372] dark:text-[#ff6600]\">Editar Empresa</h2>\n\n          <form @submit.prevent=\"submitUpdateCompany\" class=\"flex flex-col gap-3\">\n            <input v-model=\"localCompany.name\" type=\"text\" placeholder=\"Nombre de la empresa\"\n              class=\"px-3 py-2 rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none\"\n              required />\n\n            <input v-model=\"localCompany.rut\" type=\"text\" placeholder=\"RUT de la empresa\"\n              class=\"px-3 py-2 rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none\"\n              required @input=\"formatRut\" />\n\n            <input v-model=\"localCompany.contact\" type=\"text\" placeholder=\"Contacto\"\n              class=\"px-3 py-2 rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none\"\n              required />\n\n            <input v-model=\"localCompany.city\" type=\"text\" placeholder=\"Ciudad de la empresa\"\n              class=\"px-3 py-2 rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none\"\n              required />\n\n            <div class=\"mt-4\">\n              <label class=\"block mb-1 text-sm font-semibold text-[#102372] dark:text-[#ff6600]\">Plantilla /\n                Permisos:</label>\n              <div class=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\n                <div v-for=\"template in templates\" :key=\"template.id\" @click=\"localCompany.templateId = template.id\"\n                  :class=\"[\n                    'p-3 rounded-lg border cursor-pointer text-center transition',\n                    localCompany.templateId === template.id\n                      ? 'border-[#ff6600] bg-orange-100 dark:bg-[#e65500]/30'\n                      : 'border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-800'\n                  ]\">\n                  <h3 class=\"font-semibold\">{{ template.name }}</h3>\n                  <p class=\"text-gray-500 dark:text-gray-400 text-sm\">{{ template.description }}</p>\n                </div>\n              </div>\n            </div>\n          </form>\n        </div>\n\n        <div\n          class=\"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-center gap-2 bg-gray-50 dark:bg-gray-900\">\n          <button @click=\"submitUpdateCompany\"\n            class=\"bg-[#ff6600] hover:bg-[#e65500] px-4 py-2 rounded text-white font-medium\">\n            Guardar Cambios\n          </button>\n          <button @click=\"$emit('close')\" class=\"bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded text-white\">\n            Cancelar\n          </button>\n        </div>\n      </div>\n    </div>\n  </transition>\n</template>\n\n<script setup>\nimport { defineProps, defineEmits, ref, watch } from 'vue'\nimport SvgIcon from '@/components/icons/SvgIcon.vue'\n\nconst props = defineProps({\n  showEditSidebar: { type: Boolean, required: true },\n  editingCompany: { type: Object, required: true },\n  templates: { type: Array, required: true }\n})\n\nconst emit = defineEmits(['close', 'update-company'])\n\n// Usamos una copia local para evitar modificar la prop directamente antes de guardar\nconst localCompany = ref({ ...props.editingCompany })\n\n// Sincronizar localCompany cuando la prop editingCompany cambia\nwatch(() => props.editingCompany, (newVal) => {\n  localCompany.value = { ...newVal }\n}, { deep: true })\n\n\n// Lógica de validación de RUT (necesaria para guardar)\nconst isValidRut = (rut) => /^(\\d{1,2}\\.\\d{3}\\.\\d{3}-[\\dkK])$/.test(rut)\n\n// Formateo automático RUT mientras se escribe\nconst formatRut = () => {\n  let rut = localCompany.value.rut.replace(/[^0-9kK]/g, '')\n  if (rut.length > 9) rut = rut.slice(0, 9)\n\n  if (rut.length > 1) {\n    const body = rut.slice(0, -1)\n    const dv = rut.slice(-1)\n    const reversed = body.split('').reverse()\n    const withDots = []\n    reversed.forEach((char, i) => { if (i > 0 && i % 3 === 0) withDots.push('.'); withDots.push(char) })\n    localCompany.value.rut = withDots.reverse().join('') + '-' + dv\n  } else {\n    localCompany.value.rut = rut\n  }\n}\n\n// Guardar cambios\nconst submitUpdateCompany = () => {\n  if (!isValidRut(localCompany.value.rut)) {\n    alert('RUT inválido. Formato esperado: xx.xxx.xxx-x')\n    return\n  }\n\n  // Enviamos la copia modificada al padre para su actualización\n  emit('update-company', localCompany.value)\n}\n</script>\n\n<style scoped>\n/* Transiciones de la barra lateral (Se ha renombrado a 'slide-right' para claridad) */\n/* El componente de la sidebar a animar es el que tiene la clase `w-full max-w-md sm:w-96 ...` */\n.slide-right-enter-active {\n  /* Aplicamos la transición solo al transform */\n  transition: transform 0.3s ease-out; \n}\n\n.slide-right-leave-active {\n  /* Aplicamos la transición solo al transform */\n  transition: transform 0.3s ease-in;\n}\n\n.slide-right-enter-from,\n.slide-right-leave-to {\n  /* Mueve la sidebar completamente fuera de la vista hacia la derecha (100% de su propio ancho) */\n  transform: translateX(100%);\n}\n\n.slide-right-enter-to,\n.slide-right-leave-from {\n  /* Posición normal */\n  transform: translateX(0);\n}\n</style>"],"mappings":";;;AAkEA,SAAmCA,GAAG,EAAEC,KAAK,QAAQ,KAAI;AACzD,OAAOC,OAAO,MAAM,gCAA+B;;;;;;;;;;;;;;;;;;;;;;;IAEnD,MAAMC,KAAK,GAAGC,OAAA;IAMd,MAAMC,IAAI,GAAGC,MAAA;;IAEb;IACA,MAAMC,YAAY,GAAGP,GAAG,CAAC;MAAE,GAAGG,KAAK,CAACK;IAAe,CAAC;;IAEpD;IACAP,KAAK,CAAC,MAAME,KAAK,CAACK,cAAc,EAAGC,MAAM,IAAK;MAC5CF,YAAY,CAACG,KAAK,GAAG;QAAE,GAAGD;MAAO;IACnC,CAAC,EAAE;MAAEE,IAAI,EAAE;IAAK,CAAC;;IAGjB;IACA,MAAMC,UAAU,GAAIC,GAAG,IAAK,kCAAkC,CAACC,IAAI,CAACD,GAAG;;IAEvE;IACA,MAAME,SAAS,GAAGA,CAAA,KAAM;MACtB,IAAIF,GAAG,GAAGN,YAAY,CAACG,KAAK,CAACG,GAAG,CAACG,OAAO,CAAC,WAAW,EAAE,EAAE;MACxD,IAAIH,GAAG,CAACI,MAAM,GAAG,CAAC,EAAEJ,GAAG,GAAGA,GAAG,CAACK,KAAK,CAAC,CAAC,EAAE,CAAC;MAExC,IAAIL,GAAG,CAACI,MAAM,GAAG,CAAC,EAAE;QAClB,MAAME,IAAI,GAAGN,GAAG,CAACK,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;QAC5B,MAAME,EAAE,GAAGP,GAAG,CAACK,KAAK,CAAC,CAAC,CAAC;QACvB,MAAMG,QAAQ,GAAGF,IAAI,CAACG,KAAK,CAAC,EAAE,CAAC,CAACC,OAAO,CAAC;QACxC,MAAMC,QAAQ,GAAG,EAAC;QAClBH,QAAQ,CAACI,OAAO,CAAC,CAACC,IAAI,EAAEC,CAAC,KAAK;UAAE,IAAIA,CAAC,GAAG,CAAC,IAAIA,CAAC,GAAG,CAAC,KAAK,CAAC,EAAEH,QAAQ,CAACI,IAAI,CAAC,GAAG,CAAC;UAAEJ,QAAQ,CAACI,IAAI,CAACF,IAAI,CAAC;QAAC,CAAC;QACnGnB,YAAY,CAACG,KAAK,CAACG,GAAG,GAAGW,QAAQ,CAACD,OAAO,CAAC,CAAC,CAACM,IAAI,CAAC,EAAE,CAAC,GAAG,GAAG,GAAGT,EAAC;MAChE,CAAC,MAAM;QACLb,YAAY,CAACG,KAAK,CAACG,GAAG,GAAGA,GAAE;MAC7B;IACF;;IAEA;IACA,MAAMiB,mBAAmB,GAAGA,CAAA,KAAM;MAChC,IAAI,CAAClB,UAAU,CAACL,YAAY,CAACG,KAAK,CAACG,GAAG,CAAC,EAAE;QACvCkB,KAAK,CAAC,8CAA8C;QACpD;MACF;;MAEA;MACA1B,IAAI,CAAC,gBAAgB,EAAEE,YAAY,CAACG,KAAK;IAC3C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}